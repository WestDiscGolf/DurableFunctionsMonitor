{"version":3,"sources":["logo.svg","../node_modules/moment-mini/locale sync /^/.*$","registerServiceWorker.ts","components/LoginIcon.tsx","components/ErrorMessage.tsx","components/MainMenu.tsx","DateTimeHelpers.ts","states/DurableOrchestrationStatus.ts","states/OrchestrationsState.ts","components/OrchestrationLink.tsx","states/ErrorMessageState.ts","CancelToken.ts","components/Orchestrations.tsx","components/DurableEntityButtons.tsx","components/DurableEntityFields.tsx","components/OrchestrationButtons.tsx","components/OrchestrationFields.tsx","components/OrchestrationDetails.tsx","components/PurgeHistoryDialog.tsx","components/CleanEntityStorageDialog.tsx","components/Main.tsx","services/BackendClient.ts","states/LoginState.ts","states/MainMenuState.ts","states/MermaidDiagramTabState.ts","states/SequenceDiagramTabState.ts","states/GanttDiagramTabState.ts","states/LiquidMarkupTabState.ts","states/OrchestrationDetailsState.ts","states/PurgeHistoryDialogState.ts","states/CleanEntityStorageDialogState.ts","states/TypedLocalStorage.ts","services/VsCodeBackendClient.ts","states/VsCodeTypedLocalStorage.ts","states/MainState.ts","index.tsx"],"names":["module","exports","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","catch","error","LoginIcon","observer","React","render","this","props","Button","color","isLoggedInAnonymously","onClick","evt","menuAnchorElement","currentTarget","AccountCircle","Box","width","Tooltip","title","Typography","userName","Menu","anchorEl","keepMounted","open","onClose","undefined","MenuItem","logout","Dialog","isLoggedIn","DialogContent","errorMessage","Container","className","CircularProgress","DialogContentText","fontSize","ErrorMessage","action","bound","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","handleClose","SnackbarContent","message","IconButton","key","aria-label","MainMenu","componentDidMount","setWindowTitle","showConnectionParamsDialog","showPurgeHistoryDialog","showCleanEntityStorageDialog","connectionParamsDialogOpen","DialogTitle","inProgress","LinearProgress","height","isReadonly","TextField","autoFocus","margin","label","fullWidth","disabled","InputProps","readOnly","InputLabelProps","shrink","value","hubName","onChange","target","connectionString","DialogActions","saveConnectionParams","isDirty","DateTimeHelpers","t","isValid","result","moment","toISOString","slice","utc","isAfter","MinMoment","isBefore","MaxMoment","dt","HistoryEventFields","DurableOrchestrationStatus","instanceId","name","entityId","runtimeStatus","entityType","lastEvent","input","customStatus","output","createdTime","lastUpdatedTime","historyEvents","tabTemplateNames","FilterOperatorEnum","ShowEntityTypeEnum","DurableOrchestrationStatusFields","OrchestrationLink","backendClient","isVsCode","Link","href","onLinkClicked","orchestrationId","extraSanitizeHrefComponent","call","s","replace","ErrorMessageState","observable","CancelToken","OrchestrationsState","_hiddenColumns","_cancelToken","isCancelled","_orchestrations","_autoRefresh","val","_localStorage","setItem","toString","loadOrchestrations","_timeFrom","resetOrderBy","_timeTill","reloadOrchestrations","_orderByDirection","_orderBy","_filterValue","_filterOperator","_filteredColumn","_showEntityType","_oldFilterValue","_backendClient","constructor","momentFrom","super","_noMorePagesToLoad","_pageSize","_autoRefreshToken","_oldTimeFrom","_oldTimeTill","timeFromString","getItem","subtract","timeTillString","filteredColumnString","filterOperatorString","filterValueString","showEntityTypeString","autoRefreshString","Number","orderByString","orderByDirectionString","hiddenColumnsString","split","hideColumn","push","join","unhide","removeItem","applyTimeFrom","isValidMoment","applyTimeTill","applyFilterValue","setItems","fieldName","cancel","isAutoRefresh","cancelToken","timeFrom","timeTill","filterClause","OrchestrationsOnly","DurableEntitiesOnly","Equals","StartsWith","Contains","skip","length","orderByClause","orderByDirection","hiddenColumnsClause","uri","response","clearTimeout","setTimeout","err","data","finally","computed","ShowBoth","Orchestrations","document","addEventListener","scrollingElement","scrollHeight","innerHeight","scrollTop","Toolbar","variant","Grid","container","item","xs","style","marginLeft","ampm","autoOk","invalidDateMessage","format","momentAsUtc","onBlur","onAccept","onKeyPress","handleKeyPress","FormControl","InputLabel","htmlFor","Checkbox","checked","timeTillEnabled","placeholder","type","Select","filteredColumn","inputProps","col","filterOperator","filterValue","RadioGroup","showEntityType","FormControlLabel","control","Radio","flex","autoRefresh","size","FormHelperText","orchestrations","hiddenColumns","component","renderTable","renderEmptyTable","visibleColumns","filter","f","showLastEventColumn","Table","TableHead","TableRow","onlyOneVisibleColumnLeft","includes","TableCell","onMouseEnter","columnUnderMouse","onMouseLeave","TableSortLabel","active","orderBy","direction","TableBody","orchestration","cellStyle","verticalAlign","toLowerCase","InputBase","multiline","rowsMax","renderJson","event","preventDefault","json","JSON","stringify","DurableEntityButtons","renderDialogs","purgeConfirmationOpen","purge","DurableEntityFields","details","sm","md","zeroMinWidth","OrchestrationButtons","restartDialogOpen","rewindConfirmationOpen","terminateConfirmationOpen","raiseEventDialogOpen","setCustomStatusDialogOpen","rewind","terminate","eventName","rows","eventData","raiseEvent","newCustomStatus","setCustomStatus","isCustomStatusDirty","restartWithNewInstanceId","restart","OrchestrationFields","events","index","Timestamp","EventType","SubOrchestrationId","FunctionName","Name","ScheduledTime","Result","Details","OrchestrationDetails","loadDetails","tabStates","AppBar","position","Tabs","selectedTabIndex","ev","Tab","tabState","selectedTab","rawHtml","dangerouslySetInnerHTML","__html","getStyledSvg","isMermaidDiagram","description","svg","SaveAsSvgButton","URL","createObjectURL","Blob","download","PurgeHistoryDialog","dialogOpen","instancesDeleted","FormLabel","row","FormGroup","purgeHistory","RuntimeStatusCheckbox","getStatusIncluded","setStatusIncluded","CleanEntityStorageDialog","removeEmptyEntities","releaseOrphanedLocks","clean","numberOfEmptyEntitiesRemoved","numberOfOrphanedLocksRemoved","logo","require","Main","utils","MomentUtils","loginState","mainMenuState","src","Breadcrumbs","orchestrationDetailsState","Autocomplete","freeSolo","options","isExactMatch","suggestions","typedInstanceId","newValue","goto","renderInput","params","orchestrationsState","purgeHistoryDialogState","cleanEntityStorageDialogState","BackendClient","_getAuthorizationHeaderAsync","method","url","Promise","reject","headers","axios","request","process","r","LoginState","_isLoggedIn","_userName","_rootUri","_aadApp","login","get","loginWithEasyAuthConfig","getAuthorizationHeaderAsync","authParams","scopes","getCurrentConfiguration","auth","clientId","acquireTokenSilent","authResponse","accessToken","idToken","rawIdToken","Authorization","acquireTokenRedirect","easyAuthConfigResponse","config","Msal","authority","redirectUri","handleRedirectCallback","authErr","accountState","errorCode","account","getAccount","loginRedirect","MainMenuState","_inProgress","_isReadOnly","_oldConnectionString","_oldHubName","_purgeHistoryDialogState","_cleanEntityStorageDialogState","isReadOnly","alert","accountName","version","MermaidDiagramTabState","_diagramCode","_diagramSvg","_loadDetails","load","_mermaidInitialized","mermaid","initialize","startOnLoad","sequence","noteMargin","boxMargin","boxTextMargin","buildDiagram","formatDuration","durationInMs","isNaN","days","Math","floor","toFixed","hours","minutes","seconds","SequenceDiagramTabState","all","getSequenceForOrchestration","sequenceLines","orchestrationName","parentOrchestrationName","results","i","nextLine","formatDateTime","subOrchestrationName","maxDurationInMs","DurationInMs","j","substr","timestamp","GanttDiagramTabState","renderOrchestration","isParentOrchestration","startedEvent","find","completedEvent","longerThanADay","escapeOrchestrationId","lineName","formatDurationInSeconds","round","LiquidMarkupTabState","_rawHtml","_orchestrationId","OrchestrationDetailsState","_selectedTabIndex","loadCustomTabIfNeeded","_tabStates","_raiseEventDialogOpen","_setCustomStatusDialogOpen","_restartDialogOpen","requestBody","parse","setAutoRefresh","internalLoadDetails","tabStateIndex","orchId","templateName","history","PurgeHistoryDialogState","_dialogOpen","_instancesDeleted","_statuses","Set","statuses","Array","from","values","status","has","included","add","delete","CleanEntityStorageDialogState","isOpen","_response","TypedLocalStorage","_prefix","localStorage","items","VsCodeBackendClient","_vsCodeApi","_handlers","_requests","requestHandler","requestPromise","requestId","random","postMessage","setCustomHandlers","purgeHistoryHandler","cleanEntityStorageHandler","VsCodeTypedLocalStorage","_state","StateFromVsCode","save","appState","_typedInstanceId","reloadSuggestions","_suggestions","PathPrefix","vsCodeApi","acquireVsCodeApi","rootUri","OrchestrationIdFromVsCode","pos","pathname","lastIndexOf","substring","ReactDOM","getElementById","origin","fetch","indexOf","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.346b7934.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.9b5d7869.svg\";","var map = {\n\t\"./locale\": 249,\n\t\"./locale.js\": 249\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 535;","// tslint:disable:no-console\n// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the 'N+1' visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL!,\n      window.location.toString()\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker) {\n          installingWorker.onstatechange = () => {\n            if (installingWorker.state === 'installed') {\n              if (navigator.serviceWorker.controller) {\n                // At this point, the old content will have been purged and\n                // the fresh content will have been added to the cache.\n                // It's the perfect time to display a 'New content is\n                // available; please refresh.' message in your web app.\n                console.log('New content is available; please refresh.');\n              } else {\n                // At this point, everything has been precached.\n                // It's the perfect time to display a\n                // 'Content is cached for offline use.' message.\n                console.log('Content is cached for offline use.');\n              }\n            }\n          };\n        }\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type')!.indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Box, Button, Container, CircularProgress, Dialog, DialogContent, DialogContentText,\r\n    Menu, MenuItem, Tooltip, Typography\r\n} from '@material-ui/core';\r\n\r\nimport { AccountCircle, Error } from '@material-ui/icons';\r\n\r\nimport './LoginIcon.css';\r\n\r\nimport { LoginState } from '../states/LoginState';\r\n\r\n// Main Menu view\r\n@observer\r\nexport class LoginIcon extends React.Component<{ state: LoginState }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (\r\n            <div>\r\n                <Button color={state.isLoggedInAnonymously ? \"secondary\" : \"inherit\"}\r\n                    onClick={evt => state.menuAnchorElement = evt.currentTarget}\r\n                >\r\n                    <AccountCircle />\r\n                    <Box width={5} />\r\n                    <Tooltip title={state.isLoggedInAnonymously ? \"Ensure this endpoint is not exposed to the public!\" : \"\"} >\r\n                        <Typography color={state.isLoggedInAnonymously ? \"secondary\" : \"inherit\"} >\r\n                            {state.isLoggedInAnonymously ? \"Anonymous\" : state.userName}\r\n                        </Typography>\r\n                    </Tooltip>\r\n                </Button>\r\n\r\n                {!state.isLoggedInAnonymously && (\r\n                    <Menu\r\n                        anchorEl={state.menuAnchorElement}\r\n                        keepMounted\r\n                        open={!!state.menuAnchorElement}\r\n                        onClose={() => state.menuAnchorElement = undefined}\r\n                    >\r\n                        <MenuItem onClick={() => state.logout()}>Login under a different name</MenuItem>\r\n                    </Menu>\r\n                )}\r\n\r\n                <Dialog open={!state.isLoggedIn}>\r\n                    <DialogContent>\r\n\r\n                        {!state.errorMessage && (\r\n                            <div>\r\n                                <Container className=\"login-progress\">\r\n                                    <CircularProgress />\r\n                                </Container>\r\n                                <DialogContentText>Login in progress...</DialogContentText>\r\n                            </div>)}\r\n\r\n                        {!!state.errorMessage && (\r\n                            <div>\r\n                                <Container className=\"login-progress\">\r\n                                    <Error color=\"secondary\" fontSize=\"large\" />\r\n                                </Container>\r\n                                <DialogContentText color=\"secondary\">Login failed. {state.errorMessage}</DialogContentText>\r\n                            </div>)}\r\n\r\n                    </DialogContent>\r\n                </Dialog>\r\n            </div>\r\n        );\r\n    }\r\n}","import * as React from 'react';\r\nimport { action } from 'mobx'\r\nimport { observer } from 'mobx-react';\r\n\r\nimport { IconButton, Snackbar, SnackbarContent } from '@material-ui/core';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport ErrorIcon from '@material-ui/icons/Error';\r\n\r\nimport './ErrorMessage.css';\r\n\r\nimport { ErrorMessageState } from '../states/ErrorMessageState';\r\n\r\n// Error Message Snackbar\r\n@observer\r\nexport class ErrorMessage extends React.Component<{ state: ErrorMessageState }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (\r\n\r\n            <Snackbar\r\n                className=\"message-snackbar\"\r\n                anchorOrigin={{ vertical: 'top', horizontal: 'right' }}\r\n                open={!!state.errorMessage}\r\n                autoHideDuration={6000}\r\n                onClose={this.handleClose}\r\n            >\r\n                <SnackbarContent\r\n                    className=\"error-snackbar-content\"\r\n                    message={\r\n                        <span>\r\n                            <ErrorIcon className=\"error-icon\" />\r\n                            {state.errorMessage}\r\n                        </span>\r\n                    }\r\n                    action={[\r\n                        <IconButton\r\n                            key=\"close\"\r\n                            aria-label=\"Close\"\r\n                            color=\"inherit\"\r\n                            onClick={this.handleClose}\r\n                        >\r\n                            <CloseIcon />\r\n                        </IconButton>,\r\n                    ]}\r\n                />\r\n\r\n            </Snackbar>\r\n        );\r\n    }\r\n\r\n    @action.bound\r\n    private handleClose() {\r\n        this.props.state.errorMessage = '';\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Box, Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle, IconButton, LinearProgress,\r\n    Menu, MenuItem, TextField\r\n} from '@material-ui/core';\r\n\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\n\r\nimport { ErrorMessage } from './ErrorMessage';\r\nimport { MainMenuState } from '../states/MainMenuState';\r\n\r\n// Main Menu view\r\n@observer\r\nexport class MainMenu extends React.Component<{ state: MainMenuState }> {\r\n\r\n    componentDidMount() {\r\n        // Querying the backend for connection info and displaying it in window title\r\n        this.props.state.setWindowTitle();\r\n    }\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (<>\r\n            <IconButton color=\"inherit\"\r\n                onClick={evt => state.menuAnchorElement = evt.currentTarget}\r\n            >\r\n                <MenuIcon/>\r\n            </IconButton>\r\n\r\n            <Menu\r\n                anchorEl={state.menuAnchorElement}\r\n                keepMounted\r\n                open={!!state.menuAnchorElement}\r\n                onClose={() => state.menuAnchorElement = undefined}\r\n            >\r\n                <MenuItem onClick={() => state.showConnectionParamsDialog()}>Manage Storage Connection Settings...</MenuItem>\r\n                <MenuItem onClick={() => state.showPurgeHistoryDialog()}>Purge Instance History...</MenuItem>\r\n                <MenuItem onClick={() => state.showCleanEntityStorageDialog()}>Clean Entity Storage...</MenuItem>\r\n            </Menu>\r\n\r\n            <Dialog\r\n                open={state.connectionParamsDialogOpen}\r\n                onClose={() => state.connectionParamsDialogOpen = false}\r\n            >\r\n                <DialogTitle>Manage Storage Connection Settings</DialogTitle>\r\n                <DialogContent>\r\n\r\n                    {state.inProgress ? (<LinearProgress />) : (<Box height={4} />)}\r\n                    \r\n                    <DialogContentText>\r\n                        {\r\n                            state.isReadonly ?\r\n                                \"Change the below values via your application settings ('DFM_HUB_NAME' and 'AzureWebJobsStorage' respectively)\" :\r\n                                \"The below values will be saved to local.settings.json file.\"\r\n                        }\r\n                    </DialogContentText>\r\n\r\n                    <TextField\r\n                        autoFocus\r\n                        margin=\"dense\"\r\n                        label=\"Hub Name\"\r\n                        fullWidth\r\n                        disabled={state.inProgress }\r\n                        InputProps={{ readOnly: state.isReadonly }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        value={state.hubName}\r\n                        onChange={(evt) => state.hubName = evt.target.value as string}\r\n                    />\r\n\r\n                    <TextField\r\n                        autoFocus\r\n                        margin=\"dense\"\r\n                        label=\"Azure Storage Connection String\"\r\n                        fullWidth\r\n                        disabled={state.inProgress }\r\n                        InputProps={{ readOnly: state.isReadonly }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        value={state.connectionString}\r\n                        onChange={(evt) => state.connectionString = evt.target.value as string}\r\n                    />\r\n\r\n                    <ErrorMessage state={state}/>\r\n\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => state.connectionParamsDialogOpen = false} color=\"primary\">\r\n                        Cancel\r\n                    </Button>\r\n\r\n                    {(!state.isReadonly) && (\r\n                        <Button\r\n                            onClick={() => state.saveConnectionParams()}\r\n                            disabled={!state.isDirty || !state.hubName || !state.connectionString || state.inProgress}\r\n                            color=\"secondary\"\r\n                        >\r\n                            Save\r\n                        </Button>\r\n                    )}\r\n\r\n                </DialogActions>\r\n            </Dialog>\r\n        </>);\r\n    }\r\n}","import moment from 'moment';\r\n\r\nexport class DateTimeHelpers\r\n{\r\n    public static momentAsUtc(t: moment.Moment): moment.Moment {\r\n        \r\n        if (!t || !t.isValid()) {\r\n            return t;\r\n        }\r\n\r\n        // Need to convert to UTC, because @material-ui/pickers always give us local moments\r\n        const result = moment(t.toISOString(true).slice(0, 19) + 'Z');\r\n        result.utc();\r\n        return result;\r\n    }\r\n\r\n    // This is the default range for @material-ui/pickers\r\n    private static MinMoment = moment('1900-01-01').utc();\r\n    private static MaxMoment = moment('2100-01-01').utc();\r\n\r\n    public static isValidMoment(t: moment.Moment): boolean {\r\n        return !!t && t.isValid() && t.isAfter(DateTimeHelpers.MinMoment) && t.isBefore(DateTimeHelpers.MaxMoment);\r\n    }\r\n\r\n    public static formatDateTime(dt: Date) {\r\n        return dt.toISOString().slice(0, 16);\r\n    }\r\n}","\r\n// A DTO used by DurableOrchestrationStatus.historyEvents\r\nexport class HistoryEvent {\r\n    Timestamp: string;\r\n    EventType: string;\r\n    Name: string;\r\n    FunctionName: string;\r\n    ScheduledTime: string;\r\n    DurationInMs: number;\r\n    SubOrchestrationId: string;\r\n    Result: any;\r\n    Details: any;\r\n}\r\n\r\n// Could instead just iterate through field names of HistoryEvent, but reflection in TypeScript still looks tricky\r\nexport const HistoryEventFields = [\r\n    'Timestamp',\r\n    'EventType',\r\n    'Name',\r\n    'ScheduledTime',\r\n    'Result',\r\n    'Details',\r\n];\r\n\r\nexport type RuntimeStatus = \"Running\" | \"Completed\" | \"ContinuedAsNew\" | \"Failed\" | \"Canceled\" | \"Terminated\" | \"Pending\";\r\n\r\nexport type EntityType = \"Orchestration\" | \"DurableEntity\";\r\n\r\nexport class EntityId {\r\n    name: string;\r\n    key: string;\r\n}\r\n\r\n// A DTO returned by DurableOrchestrationClient.getStatusAll()\r\nexport class DurableOrchestrationStatus {\r\n    instanceId: string;\r\n    name: string;\r\n    entityId: EntityId;\r\n    runtimeStatus: RuntimeStatus;\r\n    entityType: EntityType;\r\n    lastEvent: string;\r\n    input: any;\r\n    customStatus: string;\r\n    output: any;\r\n    createdTime: string;\r\n    lastUpdatedTime: string;\r\n    historyEvents?: HistoryEvent[];\r\n    tabTemplateNames?: string[];\r\n}\r\n\r\n// Could instead just iterate through field names of DurableOrchestrationStatus, but reflection in TypeScript still looks tricky\r\nexport const DurableOrchestrationStatusFields = [\r\n    'instanceId',\r\n    'name',\r\n    'createdTime',\r\n    'lastUpdatedTime',\r\n    'runtimeStatus',\r\n    'lastEvent',\r\n    'input',\r\n    'output',\r\n    'customStatus'\r\n];","import { observable, computed } from 'mobx'\r\nimport moment from 'moment';\r\n\r\nimport { DateTimeHelpers } from '../DateTimeHelpers';\r\nimport { DurableOrchestrationStatus } from '../states/DurableOrchestrationStatus';\r\nimport { ErrorMessageState } from './ErrorMessageState';\r\nimport { IBackendClient } from '../services/IBackendClient';\r\nimport { ITypedLocalStorage } from './ITypedLocalStorage';\r\nimport { CancelToken } from '../CancelToken';\r\n\r\nexport enum FilterOperatorEnum {\r\n    Equals = 0,\r\n    StartsWith,\r\n    Contains\r\n}\r\n\r\nexport enum ShowEntityTypeEnum {\r\n    ShowBoth = 0,\r\n    OrchestrationsOnly,\r\n    DurableEntitiesOnly\r\n}\r\n\r\n// State of Orchestrations view\r\nexport class OrchestrationsState extends ErrorMessageState {\r\n\r\n    @computed\r\n    get hiddenColumns(): string[] { return this._hiddenColumns; }\r\n\r\n    @computed\r\n    get inProgress(): boolean { return this._cancelToken.inProgress && !this._cancelToken.isCancelled; }\r\n\r\n    @computed\r\n    get orchestrations(): DurableOrchestrationStatus[] { return this._orchestrations; }\r\n\r\n    @computed\r\n    get autoRefresh(): number { return this._autoRefresh; }\r\n    set autoRefresh(val: number) {\r\n        this._autoRefresh = val;\r\n        this._localStorage.setItem('autoRefresh', this._autoRefresh.toString());\r\n        this.loadOrchestrations(true);\r\n    }\r\n\r\n    @computed\r\n    get timeFrom(): moment.Moment { return this._timeFrom; }\r\n    set timeFrom(val: moment.Moment) {\r\n        this._timeFrom = val;\r\n        this.resetOrderBy();\r\n    }\r\n\r\n    @computed\r\n    get timeTill(): moment.Moment { return (!this._timeTill) ? moment().utc() : this._timeTill; }\r\n    set timeTill(val: moment.Moment) {\r\n        this._timeTill = val;\r\n        this.resetOrderBy();\r\n    }\r\n    \r\n    @computed\r\n    get timeTillEnabled(): boolean { return !!this._timeTill; }\r\n    set timeTillEnabled(val: boolean) {\r\n\r\n        this._timeTill = val ? moment().utc() : null;\r\n\r\n        if (!val) {\r\n            this.resetOrderBy();\r\n            this.reloadOrchestrations();\r\n        }\r\n    }\r\n    \r\n    @computed\r\n    get orderByDirection(): ('asc' | 'desc') { return this._orderByDirection;}\r\n\r\n    @computed\r\n    get orderBy() : string { return this._orderBy; }\r\n    set orderBy(val: string) {\r\n\r\n        if (this._orderBy !== val) {\r\n            \r\n            this._orderBy = val;\r\n            this._orderByDirection = 'asc';\r\n\r\n        } else if (this._orderByDirection === 'desc') {\r\n\r\n            this.resetOrderBy();\r\n        }\r\n        else {\r\n            this._orderByDirection = 'desc';\r\n        }\r\n\r\n        this.reloadOrchestrations();\r\n    }\r\n\r\n    @computed\r\n    get filterValue(): string { return this._filterValue; }\r\n    set filterValue(val: string) { this._filterValue = val; }\r\n\r\n    @computed\r\n    get filterOperator(): FilterOperatorEnum { return this._filterOperator; }\r\n    set filterOperator(val: FilterOperatorEnum) {\r\n        \r\n        this._filterOperator = val;\r\n\r\n        if (!!this._filterValue && this._filteredColumn !== '0') {\r\n\r\n            this.reloadOrchestrations();\r\n        }\r\n    }\r\n\r\n    @computed\r\n    get filteredColumn(): string { return this._filteredColumn; }\r\n    set filteredColumn(val: string) {\r\n\r\n        this._filteredColumn = val;\r\n\r\n        if (!this._filterValue) {\r\n            return;\r\n        }\r\n\r\n        if (this._filteredColumn === '0') {\r\n            this._filterValue = '';\r\n        }\r\n\r\n        this.reloadOrchestrations();\r\n    }\r\n\r\n    @computed\r\n    get showEntityType(): string { return ShowEntityTypeEnum[this._showEntityType]; }\r\n    set showEntityType(val: string) {\r\n\r\n        this._showEntityType = ShowEntityTypeEnum[val];\r\n\r\n        this.reloadOrchestrations();\r\n    }\r\n\r\n    @computed\r\n    get showLastEventColumn(): boolean {\r\n        // Only showing lastEvent field when being filtered by it (because otherwise it is not populated on the server)\r\n        return this._filteredColumn === 'lastEvent' && (!!this._oldFilterValue);\r\n    }\r\n\r\n    @observable\r\n    columnUnderMouse: string;\r\n    \r\n    get backendClient(): IBackendClient { return this._backendClient; }\r\n\r\n    constructor(private _backendClient: IBackendClient, private _localStorage: ITypedLocalStorage<OrchestrationsState>) {\r\n        super();\r\n        \r\n        var momentFrom: moment.Moment;\r\n        const timeFromString = this._localStorage.getItem('timeFrom');\r\n        if (!!timeFromString) {\r\n            momentFrom = moment(timeFromString);\r\n        } else {\r\n            // By default setting it to 24 hours ago\r\n            momentFrom = moment().subtract(1, 'days');\r\n        }\r\n        momentFrom.utc();\r\n\r\n        this._timeFrom = momentFrom;\r\n        this._oldTimeFrom = momentFrom;\r\n       \r\n        const timeTillString = this._localStorage.getItem('timeTill');\r\n        if (!!timeTillString) {\r\n            this._timeTill = moment(timeTillString);\r\n            this._timeTill.utc();\r\n            this._oldTimeTill = this._timeTill;\r\n        }\r\n\r\n        const filteredColumnString = this._localStorage.getItem('filteredColumn');\r\n        if (!!filteredColumnString) {\r\n            this._filteredColumn = filteredColumnString;\r\n        }\r\n\r\n        const filterOperatorString = this._localStorage.getItem('filterOperator');\r\n        if (!!filterOperatorString) {\r\n            this._filterOperator = FilterOperatorEnum[filterOperatorString];\r\n        }\r\n\r\n        const filterValueString = this._localStorage.getItem('filterValue');\r\n        if (!!filterValueString) {\r\n            this._filterValue = filterValueString;\r\n            this._oldFilterValue = filterValueString;\r\n        }\r\n\r\n        const showEntityTypeString = this._localStorage.getItem('showEntityType');\r\n        if (!!showEntityTypeString) {\r\n            this._showEntityType = ShowEntityTypeEnum[showEntityTypeString];\r\n        }\r\n\r\n        const autoRefreshString = this._localStorage.getItem('autoRefresh');\r\n        if (!!autoRefreshString) {\r\n            this._autoRefresh = Number(autoRefreshString);\r\n        }\r\n\r\n        const orderByString = this._localStorage.getItem('orderBy');\r\n        if (!!orderByString) {\r\n            this._orderBy = orderByString;\r\n        }\r\n\r\n        const orderByDirectionString = this._localStorage.getItem('orderByDirection');\r\n        if (!!orderByDirectionString) {\r\n            this._orderByDirection = orderByDirectionString as 'asc' | 'desc';\r\n        }\r\n\r\n        const hiddenColumnsString = this._localStorage.getItem('hiddenColumns');\r\n        if (!!hiddenColumnsString) {\r\n            this._hiddenColumns = hiddenColumnsString.split('|');\r\n        }\r\n\r\n    }\r\n\r\n    hideColumn(name: string) {\r\n        this._hiddenColumns.push(name);\r\n        this._localStorage.setItem('hiddenColumns', this._hiddenColumns.join('|'));\r\n    }\r\n\r\n    unhide() {\r\n        this._hiddenColumns = [];\r\n        this._localStorage.removeItem('hiddenColumns');\r\n        this.reloadOrchestrations();\r\n    }\r\n\r\n    applyTimeFrom() {\r\n        if (DateTimeHelpers.isValidMoment(this._timeFrom) && this._oldTimeFrom !== this._timeFrom) {\r\n            this.reloadOrchestrations();\r\n        }\r\n    }\r\n\r\n    applyTimeTill() {\r\n        if (DateTimeHelpers.isValidMoment(this._timeTill) && this._oldTimeTill !== this._timeTill) {\r\n            this.reloadOrchestrations();\r\n        }\r\n    }\r\n\r\n    applyFilterValue() {\r\n        if (this._oldFilterValue !== this._filterValue) {\r\n            this.reloadOrchestrations();\r\n        }\r\n    }\r\n\r\n    reloadOrchestrations() {\r\n        this._orchestrations = [];\r\n        this._noMorePagesToLoad = false;\r\n\r\n        // If dates are invalid, reverting them to previous valid values\r\n        if (!DateTimeHelpers.isValidMoment(this._timeFrom)) {\r\n            this._timeFrom = this._oldTimeFrom;\r\n        }\r\n        if (!!this._timeTill && !DateTimeHelpers.isValidMoment(this._timeTill)) {\r\n            this._timeTill = this._oldTimeTill;\r\n        }\r\n\r\n        // persisting state as a batch\r\n        this._localStorage.setItems([\r\n            { fieldName: 'timeFrom', value: this._timeFrom.toISOString() },\r\n            { fieldName: 'timeTill', value: !!this._timeTill ? this._timeTill.toISOString() : null },\r\n            { fieldName: 'filteredColumn', value: this._filteredColumn },\r\n            { fieldName: 'filterOperator', value: FilterOperatorEnum[this._filterOperator] },\r\n            { fieldName: 'filterValue', value: !!this._filterValue ? this._filterValue : null },\r\n            { fieldName: 'showEntityType', value: ShowEntityTypeEnum[this._showEntityType] },\r\n            { fieldName: 'orderBy', value: this._orderBy },\r\n            { fieldName: 'orderByDirection', value: this._orderByDirection },\r\n        ]);\r\n\r\n        this.loadOrchestrations();\r\n\r\n        this._oldFilterValue = this._filterValue;\r\n        this._oldTimeFrom = this._timeFrom;\r\n        this._oldTimeTill = this._timeTill;\r\n    }\r\n\r\n    cancel() {\r\n        this._cancelToken.isCancelled = true;\r\n        this._cancelToken = new CancelToken();\r\n    }\r\n\r\n    loadOrchestrations(isAutoRefresh: boolean = false) {\r\n\r\n        const cancelToken = this._cancelToken;\r\n        if (!!cancelToken.inProgress || (!!this._noMorePagesToLoad && !this._autoRefresh )) {\r\n            return;            \r\n        }\r\n        cancelToken.inProgress = true;\r\n        \r\n        const timeFrom = this._timeFrom.toISOString();\r\n        const timeTill = !!this._timeTill ? this._timeTill.toISOString() : moment().utc().toISOString();\r\n        var filterClause = `&$filter=createdTime ge '${timeFrom}' and createdTime le '${timeTill}'`;\r\n\r\n        if (this._showEntityType === ShowEntityTypeEnum.OrchestrationsOnly) {\r\n            filterClause += ` and entityType eq 'Orchestration'`;\r\n        }\r\n        else if (this._showEntityType === ShowEntityTypeEnum.DurableEntitiesOnly) {\r\n            filterClause += ` and entityType eq 'DurableEntity'`;\r\n        }\r\n        \r\n        if (!!this._filterValue && this._filteredColumn !== '0') {\r\n\r\n            filterClause += ' and ';\r\n\r\n            switch (this._filterOperator) {\r\n                case FilterOperatorEnum.Equals:\r\n                    filterClause += `${this._filteredColumn} eq '${this._filterValue}'`;\r\n                break;\r\n                case FilterOperatorEnum.StartsWith:\r\n                    filterClause += `startswith(${this._filteredColumn}, '${this._filterValue}')`;\r\n                break;\r\n                case FilterOperatorEnum.Contains:\r\n                    filterClause += `contains(${this._filteredColumn}, '${this._filterValue}')`;\r\n                break;\r\n            }\r\n        }\r\n\r\n        // In auto-refresh mode only refreshing the first page\r\n        const skip = isAutoRefresh ? 0 : this._orchestrations.length;\r\n\r\n        const orderByClause = !!this._orderBy ? `&$orderby=${this._orderBy} ${this.orderByDirection}` : '';\r\n        const hiddenColumnsClause = !this._hiddenColumns.length ? '' : `&hidden-columns=${this._hiddenColumns.join('|')}`; \r\n\r\n        const uri = `/orchestrations?$top=${this._pageSize}&$skip=${skip}${filterClause}${orderByClause}${hiddenColumnsClause}`;\r\n\r\n        this._backendClient.call('GET', uri).then(response => {\r\n\r\n            if (!cancelToken.isCancelled)\r\n            {\r\n                if (!response.length) {\r\n\r\n                    // Stop the infinite scrolling\r\n                    this._noMorePagesToLoad = true;\r\n\r\n                } else {\r\n\r\n                    if (isAutoRefresh) {\r\n                        this._orchestrations = response;\r\n                    } else {\r\n                        this._orchestrations.push(...response);\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Doing auto-refresh\r\n            if (!!this._autoRefresh) {\r\n\r\n                if (!!this._autoRefreshToken) {\r\n                    clearTimeout(this._autoRefreshToken);\r\n                }\r\n                this._autoRefreshToken = setTimeout(() => this.loadOrchestrations(true), this._autoRefresh * 1000);\r\n            }\r\n\r\n        }, err => {\r\n\r\n            // Cancelling auto-refresh just in case\r\n            this._autoRefresh = 0;\r\n\r\n            if (!cancelToken.isCancelled) {\r\n                this.errorMessage = `Load failed: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n            }\r\n\r\n        }).finally(() => {\r\n            cancelToken.inProgress = false;\r\n        });\r\n    }\r\n\r\n    @observable\r\n    private _cancelToken: CancelToken = new CancelToken();\r\n    @observable\r\n    private _orchestrations: DurableOrchestrationStatus[] = [];\r\n    @observable\r\n    private _orderByDirection: ('asc' | 'desc') = 'asc';\r\n    @observable\r\n    private _orderBy: string = '';\r\n    @observable\r\n    private _autoRefresh: number = 0;\r\n\r\n    @observable\r\n    private _timeFrom: moment.Moment;\r\n    @observable\r\n    private _timeTill: moment.Moment;\r\n\r\n    @observable\r\n    private _filterValue: string = '';\r\n    @observable\r\n    private _filterOperator: FilterOperatorEnum = FilterOperatorEnum.Equals;\r\n    @observable\r\n    private _filteredColumn: string = '0';\r\n    @observable\r\n    private _showEntityType: ShowEntityTypeEnum = ShowEntityTypeEnum.ShowBoth;\r\n\r\n    @observable\r\n    private _hiddenColumns: string[] = [];\r\n\r\n    private _noMorePagesToLoad: boolean = false;\r\n    private readonly _pageSize = 50;\r\n    private _autoRefreshToken: NodeJS.Timeout;\r\n    private _oldFilterValue: string = '';\r\n\r\n    private _oldTimeFrom: moment.Moment;\r\n    private _oldTimeTill: moment.Moment;\r\n\r\n    private resetOrderBy() {\r\n        this._orderBy = '';\r\n        this._orderByDirection = 'asc';\r\n    }\r\n}","import * as React from 'react';\r\nimport { action } from 'mobx'\r\nimport { observer } from 'mobx-react';\r\n\r\nimport { Link } from '@material-ui/core';\r\n\r\nimport { IBackendClient } from '../services/IBackendClient';\r\n\r\n// Renders a link to be opened either in a new browser tab or in a new VsCode WebView\r\n@observer\r\nexport class OrchestrationLink extends React.Component<{ orchestrationId: string, title?: string, backendClient: IBackendClient }> {\r\n\r\n    render(): JSX.Element {\r\n\r\n        if (this.props.backendClient.isVsCode) {\r\n\r\n            return (\r\n                <Link href=\"/\" onClick={this.onLinkClicked} >\r\n                    {this.props.title ?? this.props.orchestrationId}\r\n                </Link>\r\n            );            \r\n        } else {\r\n\r\n            return (\r\n                <Link href={`/orchestrations/${this.extraSanitizeHrefComponent(this.props.orchestrationId)}`} target=\"_blank\">\r\n                    {this.props.title ?? this.props.orchestrationId}\r\n                </Link>\r\n            );\r\n        }\r\n    }\r\n\r\n    @action.bound\r\n    private onLinkClicked() {\r\n        this.props.backendClient.call('OpenInNewWindow', this.props.orchestrationId);\r\n    }\r\n\r\n    // Just to be extra sure\r\n    private extraSanitizeHrefComponent(s: string): string{\r\n        return s.replace(/javascript:/gi, '');\r\n    }\r\n}","import { observable } from 'mobx'\r\n\r\n// State of Error Message snackbar\r\nexport class ErrorMessageState {\r\n\r\n    @observable\r\n    errorMessage: string = '';\r\n}","import { observable } from 'mobx'\r\n\r\nexport class CancelToken {\r\n    @observable\r\n    inProgress: boolean = false;\r\n    @observable\r\n    isCancelled: boolean = false;\r\n}\r\n","import * as React from 'react';\r\nimport { action } from 'mobx'\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Box, Button, Checkbox, FormControl, FormControlLabel, FormHelperText, Grid, IconButton, InputBase,\r\n    InputLabel, Link, LinearProgress, MenuItem, Select,\r\n    Table, TableBody, TableCell, TableHead, TableRow, TableSortLabel, TextField, Toolbar, Typography,\r\n    Radio, RadioGroup\r\n} from '@material-ui/core';\r\n\r\nimport { KeyboardDateTimePicker } from '@material-ui/pickers';\r\n\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport RefreshIcon from '@material-ui/icons/Refresh';\r\nimport CancelOutlinedIcon from '@material-ui/icons/CancelOutlined';\r\n\r\nimport './Orchestrations.css';\r\n\r\nimport { DateTimeHelpers } from '../DateTimeHelpers';\r\nimport { DurableOrchestrationStatusFields } from '../states/DurableOrchestrationStatus';\r\nimport { ErrorMessage } from './ErrorMessage';\r\nimport { OrchestrationLink } from './OrchestrationLink';\r\nimport { OrchestrationsState, ShowEntityTypeEnum } from '../states/OrchestrationsState';\r\n\r\nconst MaxJsonLengthToShow = 1024;\r\n\r\n// Orchestrations view\r\n@observer\r\nexport class Orchestrations extends React.Component<{ state: OrchestrationsState }> {\r\n\r\n    componentDidMount() {\r\n\r\n        // Triggering initial load\r\n        this.props.state.loadOrchestrations();\r\n\r\n        // Doing a simple infinite scroll\r\n        document.addEventListener('scroll', (evt) => {\r\n\r\n            const scrollingElement = (evt.target as Document).scrollingElement;\r\n            if (!scrollingElement) { \r\n                return;\r\n            }\r\n\r\n            const scrollPos = scrollingElement.scrollHeight - window.innerHeight - scrollingElement.scrollTop;\r\n            const scrollPosThreshold = 100;\r\n\r\n            if (scrollPos < scrollPosThreshold) {\r\n                this.props.state.loadOrchestrations();\r\n            }\r\n        });\r\n    }\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (<>\r\n            \r\n            {state.inProgress ? (<LinearProgress />) : (<Box height={4} />)}\r\n\r\n            <Toolbar variant=\"dense\" className=\"top-toolbar\">\r\n\r\n                <Grid container className=\"toolbar-grid1\">\r\n                    <Grid item xs={12}>\r\n\r\n                        <KeyboardDateTimePicker\r\n                            className=\"from-input\"\r\n                            style={{ marginLeft: 10 }}\r\n                            ampm={false}\r\n                            autoOk={true}\r\n                            label=\"From &nbsp;&nbsp; (UTC)\"\r\n                            invalidDateMessage=\"\"\r\n                            format={\"YYYY-MM-DD HH:mm:ss\"}\r\n                            disabled={state.inProgress}\r\n                            value={state.timeFrom}\r\n                            onChange={(t) => state.timeFrom = DateTimeHelpers.momentAsUtc(t)}\r\n                            onBlur={() => state.applyTimeFrom()}\r\n                            onAccept={() => state.applyTimeFrom()}\r\n                            onKeyPress={this.handleKeyPress}\r\n                        />\r\n\r\n                    </Grid>\r\n                    <Grid item xs={12} className=\"toolbar-grid1-item2\">\r\n                        <FormControl>\r\n                            <InputLabel className=\"till-label\" htmlFor=\"till-checkbox\" shrink >Till</InputLabel>\r\n                            <Checkbox\r\n                                id=\"till-checkbox\"\r\n                                className=\"till-checkbox\"\r\n                                disabled={state.inProgress}\r\n                                checked={state.timeTillEnabled}\r\n                                onChange={(evt) => state.timeTillEnabled = evt.target.checked}\r\n                            />\r\n                        </FormControl>\r\n\r\n                        {state.timeTillEnabled ? (\r\n                            <KeyboardDateTimePicker\r\n                                className=\"till-input\"\r\n                                ampm={false}\r\n                                autoOk={true}\r\n                                label=\"(UTC)\"\r\n                                invalidDateMessage=\"\"\r\n                                format={\"YYYY-MM-DD HH:mm:ss\"}\r\n                                disabled={state.inProgress}\r\n                                value={state.timeTill}\r\n                                onChange={(t) => state.timeTill = DateTimeHelpers.momentAsUtc(t)}\r\n                                onBlur={() => state.applyTimeTill()}\r\n                                onAccept={() => state.applyTimeTill()}\r\n                                onKeyPress={this.handleKeyPress}\r\n                            />\r\n                        ) : (\r\n                            <TextField\r\n                                className=\"till-input\"\r\n                                label=\"(UTC)\"\r\n                                placeholder=\"[Now]\"\r\n                                InputLabelProps={{ shrink: true }}\r\n                                type=\"text\"\r\n                                disabled={true}\r\n                            />\r\n                        )}                        \r\n                        \r\n                    </Grid>\r\n                </Grid>\r\n\r\n                <Grid container className=\"toolbar-grid2\">\r\n                    <Grid item xs={12}>\r\n                        <FormControl>\r\n                            <InputLabel htmlFor=\"filtered-column-select\">Filtered Column</InputLabel>\r\n                            <Select\r\n                                className=\"toolbar-select filtered-column-input\"\r\n                                disabled={state.inProgress}\r\n                                value={state.filteredColumn}\r\n                                onChange={(evt) => state.filteredColumn = evt.target.value as string}\r\n                                inputProps={{ id: \"filtered-column-select\" }}>\r\n\r\n                                <MenuItem value=\"0\">[Not Selected]</MenuItem>\r\n                                {DurableOrchestrationStatusFields.map(col => {\r\n                                    return (<MenuItem key={col} value={col}>{col}</MenuItem>);\r\n                                })}\r\n\r\n                            </Select>\r\n                        </FormControl>\r\n                        <FormControl className=\"toolbar-grid2-item1-select\">\r\n                            <InputLabel htmlFor=\"filter-operator-select\">Filter Operator</InputLabel>\r\n                            <Select\r\n                                className=\"toolbar-select\"\r\n                                disabled={state.inProgress}\r\n                                value={state.filterOperator}\r\n                                onChange={(evt) => state.filterOperator = evt.target.value as number}\r\n                                inputProps={{ id: \"filter-operator-select\" }}>\r\n                                <MenuItem value={0}>Equals</MenuItem>\r\n                                <MenuItem value={1}>Starts With</MenuItem>\r\n                                <MenuItem value={2}>Contains</MenuItem>\r\n                            </Select>\r\n                        </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={12} className=\"toolbar-grid2-item2\">\r\n                        <TextField\r\n                            className=\"filter-value-input\"\r\n                            label=\"Filter Value\"\r\n                            InputLabelProps={{ shrink: true }}\r\n                            placeholder=\"[some text or 'null']\"\r\n                            disabled={state.filteredColumn === '0' || state.inProgress}\r\n                            value={state.filterValue}\r\n                            onChange={(evt) => state.filterValue = evt.target.value as string}\r\n                            onBlur={() => state.applyFilterValue()}\r\n                            onKeyPress={this.handleKeyPress}\r\n                        />\r\n                    </Grid>\r\n                </Grid>\r\n\r\n                <RadioGroup\r\n                    value={state.showEntityType}\r\n                    onChange={(evt) => state.showEntityType = (evt.target as HTMLInputElement).value}\r\n                >\r\n                    <FormControlLabel                            \r\n                        className=\"entity-type-radio\"\r\n                        disabled={state.inProgress}\r\n                        value={ShowEntityTypeEnum[ShowEntityTypeEnum.ShowBoth]}\r\n                        control={<Radio />}\r\n                        label={<Typography variant=\"subtitle2\">Show both</Typography>}\r\n                    />\r\n                    <FormControlLabel\r\n                        className=\"entity-type-radio\"\r\n                        disabled={state.inProgress}\r\n                        value={ShowEntityTypeEnum[ShowEntityTypeEnum.OrchestrationsOnly]}\r\n                        control={<Radio />}\r\n                        label={<Typography variant=\"subtitle2\">Orchestrations only</Typography>}\r\n                    />\r\n                    <FormControlLabel\r\n                        className=\"entity-type-radio\"\r\n                        disabled={state.inProgress}\r\n                        value={ShowEntityTypeEnum[ShowEntityTypeEnum.DurableEntitiesOnly]}\r\n                        control={<Radio />}\r\n                        label={<Typography variant=\"subtitle2\">Durable Entities only</Typography>}\r\n                    />\r\n                </RadioGroup>\r\n\r\n                <Typography style={{ flex: 1 }} />\r\n\r\n                <Grid container className=\"toolbar-grid3\">\r\n                    <Grid item xs={12}>\r\n                        <FormControl className=\"form-control-float-right\">\r\n                            <InputLabel htmlFor=\"auto-refresh-select\">Auto-refresh</InputLabel>\r\n                            <Select\r\n                                className=\"toolbar-select\"\r\n                                inputProps={{ id: \"auto-refresh-select\" }}\r\n                                value={state.autoRefresh}\r\n                                onChange={(evt) => state.autoRefresh = evt.target.value as number}\r\n                            >\r\n                                <MenuItem value={0}>Never</MenuItem>\r\n                                <MenuItem value={1}>Every 1 sec.</MenuItem>\r\n                                <MenuItem value={5}>Every 5 sec.</MenuItem>\r\n                                <MenuItem value={10}>Every 10 sec.</MenuItem>\r\n                            </Select>\r\n                        </FormControl>\r\n                    </Grid>\r\n                    <Grid item xs={12} className=\"toolbar-grid3-item2\">\r\n                        <Button\r\n                            className=\"refresh-button form-control-float-right\"\r\n                            variant=\"outlined\"\r\n                            color=\"default\"\r\n                            size=\"large\"\r\n                            onClick={() => state.inProgress ? state.cancel() : state.reloadOrchestrations()}\r\n                        >\r\n                            {state.inProgress ? (<CancelOutlinedIcon />) : (<RefreshIcon />)}\r\n                        </Button>\r\n                    </Grid>\r\n                </Grid>\r\n\r\n            </Toolbar>\r\n\r\n            <FormHelperText className=\"items-count-label\">\r\n                {!!state.orchestrations.length && (<>\r\n                    \r\n                    {`${state.orchestrations.length} items shown`}\r\n\r\n                    {!!state.hiddenColumns.length && (<>\r\n                        {`, ${state.hiddenColumns.length} columns hidden `}\r\n                        ( <Link\r\n                                className=\"unhide-button\"\r\n                                component=\"button\"\r\n                                variant=\"inherit\"\r\n                                onClick={() => state.unhide()}\r\n                            >\r\n                                unhide\r\n                        </Link> )\r\n                        \r\n                    </>)}\r\n                </>)}\r\n\r\n            </FormHelperText>\r\n\r\n            {!!state.orchestrations.length ? this.renderTable(state) : this.renderEmptyTable()}\r\n\r\n            {state.inProgress && !!state.orchestrations.length ? (<LinearProgress />) : (<Box height={4} />)}\r\n            <Toolbar variant=\"dense\" />\r\n            \r\n            <ErrorMessage state={this.props.state} />\r\n            \r\n        </>);\r\n    }\r\n\r\n    private renderEmptyTable(): JSX.Element {\r\n        return (\r\n            <Typography variant=\"h5\" className=\"empty-table-placeholder\" >\r\n                This list is empty\r\n            </Typography>\r\n        );\r\n    }\r\n\r\n    private renderTable(state: OrchestrationsState): JSX.Element {\r\n\r\n        const visibleColumns = DurableOrchestrationStatusFields\r\n            // hiding artificial 'lastEvent' column, when not used\r\n            .filter(f => state.showLastEventColumn ? true : f !== 'lastEvent');\r\n\r\n        return (\r\n            <Table size=\"small\">\r\n                <TableHead>\r\n                    <TableRow>\r\n                        {visibleColumns.map(col => {\r\n\r\n                            const onlyOneVisibleColumnLeft = visibleColumns.length <= state.hiddenColumns.length + 1;\r\n\r\n                            return !state.hiddenColumns.includes(col) && (\r\n                                <TableCell key={col}\r\n                                    onMouseEnter={() => state.columnUnderMouse = col}\r\n                                    onMouseLeave={() => state.columnUnderMouse = ''}\r\n                                >\r\n                                    <TableSortLabel\r\n                                        active={state.orderBy === col}\r\n                                        direction={state.orderByDirection}\r\n                                        onClick={() => state.orderBy = col}\r\n                                    >\r\n                                        {col}\r\n                                    </TableSortLabel>\r\n\r\n                                    {state.columnUnderMouse === col && !onlyOneVisibleColumnLeft && (\r\n                                        <IconButton\r\n                                            color=\"inherit\"\r\n                                            size=\"small\"\r\n                                            className=\"column-hide-button\"\r\n                                            onClick={() => state.hideColumn(col)}\r\n                                        >\r\n                                            <CloseIcon />\r\n                                        </IconButton>                                        \r\n                                    )}\r\n\r\n                                </TableCell>\r\n                            );\r\n                        })}\r\n                    </TableRow>\r\n                </TableHead>\r\n                <TableBody>\r\n                    {state.orchestrations.map(orchestration => {\r\n\r\n                        const cellStyle = { verticalAlign: 'top' };\r\n                        return (\r\n                            <TableRow\r\n                                key={orchestration.instanceId}\r\n                                className={\"runtime-status-\" + orchestration.runtimeStatus.toString().toLowerCase()}\r\n                            >\r\n                                {!state.hiddenColumns.includes('instanceId') && (\r\n                                    <TableCell className=\"instance-id-cell\" style={cellStyle}>\r\n                                        <OrchestrationLink orchestrationId={orchestration.instanceId} backendClient={state.backendClient} />\r\n                                    </TableCell>\r\n                                )}\r\n                                {!state.hiddenColumns.includes('name') && (\r\n                                    <TableCell className=\"name-cell\" style={cellStyle}>\r\n                                        {orchestration.name}\r\n                                    </TableCell>\r\n                                )}\r\n                                {!state.hiddenColumns.includes('createdTime') && (\r\n                                    <TableCell className=\"datetime-cell\" style={cellStyle}>\r\n                                        {orchestration.createdTime}\r\n                                    </TableCell>\r\n                                )}\r\n                                {!state.hiddenColumns.includes('lastUpdatedTime') && (\r\n                                    <TableCell className=\"datetime-cell\" style={cellStyle}>\r\n                                        {orchestration.lastUpdatedTime}\r\n                                    </TableCell>\r\n                                )}\r\n                                {!state.hiddenColumns.includes('runtimeStatus') && (\r\n                                    <TableCell style={cellStyle}>\r\n                                        {orchestration.runtimeStatus}\r\n                                    </TableCell>\r\n                                )}\r\n                                {!state.hiddenColumns.includes('lastEvent') && state.showLastEventColumn && (\r\n                                    <TableCell style={cellStyle}>\r\n                                        {orchestration.lastEvent}\r\n                                    </TableCell>\r\n                                )}\r\n                                {!state.hiddenColumns.includes('input') && (\r\n                                    <TableCell className=\"long-text-cell\" style={cellStyle}>\r\n                                        <InputBase\r\n                                            className=\"long-text-cell-input\"\r\n                                            multiline fullWidth rowsMax={5} readOnly\r\n                                            value={this.renderJson(orchestration.input)}\r\n                                        />\r\n                                    </TableCell>\r\n                                )}\r\n                                {!state.hiddenColumns.includes('output') && (\r\n                                    <TableCell className=\"output-cell\" style={cellStyle}>\r\n                                        <InputBase\r\n                                            className=\"long-text-cell-input\"\r\n                                            multiline fullWidth rowsMax={5} readOnly\r\n                                            value={this.renderJson(orchestration.output)}\r\n                                        />\r\n                                    </TableCell>\r\n                                )}\r\n                                {!state.hiddenColumns.includes('customStatus') && (\r\n                                    <TableCell className=\"output-cell\" style={cellStyle}>\r\n                                        <InputBase\r\n                                            className=\"long-text-cell-input\"\r\n                                            multiline fullWidth rowsMax={5} readOnly\r\n                                            value={this.renderJson(orchestration.customStatus)}\r\n                                        />\r\n                                    </TableCell>\r\n                                )}\r\n                            </TableRow>\r\n                        );\r\n                    })}\r\n                </TableBody>\r\n            </Table>\r\n        );\r\n    }\r\n\r\n    @action.bound\r\n    private handleKeyPress(event: React.KeyboardEvent<HTMLInputElement>) {\r\n        if (event.key === 'Enter') {\r\n            // Otherwise the event will bubble up and the form will be submitted\r\n            event.preventDefault();\r\n\r\n            this.props.state.reloadOrchestrations();\r\n        }\r\n    }\r\n\r\n    private renderJson(json: any): string {\r\n\r\n        const result = JSON.stringify(json);\r\n\r\n        return result.length > MaxJsonLengthToShow ? `[${result.length} symbols long JSON]` : result;\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle,\r\n} from '@material-ui/core';\r\n\r\nimport { OrchestrationDetailsState } from '../states/OrchestrationDetailsState';\r\n\r\n// Buttons for detailed durable entity view\r\n@observer\r\nexport class DurableEntityButtons extends React.Component<{ state: OrchestrationDetailsState, disabled: boolean }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (<>\r\n\r\n            {this.renderDialogs(state)}\r\n\r\n            <Button variant=\"outlined\" color=\"primary\" size=\"large\" disabled={this.props.disabled} onClick={() => state.purgeConfirmationOpen = true}>\r\n                Purge\r\n            </Button>            \r\n        </>);\r\n    }\r\n\r\n    private renderDialogs(state: OrchestrationDetailsState): JSX.Element {\r\n        return (<>\r\n\r\n            <Dialog\r\n                open={state.purgeConfirmationOpen}\r\n                onClose={() => state.purgeConfirmationOpen = false}\r\n            >\r\n                <DialogTitle>Confirm Purge</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        You're about to purge entity '{state.orchestrationId}'. This operation drops entity state from the underlying storage and cannot be undone. Are you sure?\r\n                    </DialogContentText>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => state.purgeConfirmationOpen = false} color=\"primary\" autoFocus>\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={() => state.purge()} color=\"secondary\">\r\n                        Yes, purge\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n        </>);\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Grid, TextField\r\n} from '@material-ui/core';\r\n\r\nimport { DurableOrchestrationStatus } from '../states/DurableOrchestrationStatus';\r\n\r\n// Fields for detailed durable entity view\r\n@observer\r\nexport class DurableEntityFields extends React.Component<{ details: DurableOrchestrationStatus }> {\r\n\r\n    render(): JSX.Element {\r\n        const details = this.props.details;\r\n\r\n        return (<>\r\n            <Grid container className=\"grid-container\">\r\n                <Grid item xs={12} sm={12} md={3} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"entityId.name\"\r\n                        value={details.entityId?.name}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n\r\n                <Grid item xs={12} sm={6} md={3} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"entityId.key\"\r\n                        value={details.entityId?.key}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n\r\n                <Grid item xs={12} sm={6} md={2} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"createdTime\"\r\n                        value={details.createdTime}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={2} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"lastUpdatedTime\"\r\n                        value={details.lastUpdatedTime}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={2} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"runtimeStatus\"\r\n                        value={details.runtimeStatus}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        className={!!details.runtimeStatus ? \"runtime-status-\" + details.runtimeStatus.toLowerCase() : \"\"}\r\n                    />\r\n                </Grid>\r\n                \r\n                <Grid item xs={12} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"input\"\r\n                        value={JSON.stringify(details.input, null, 3)}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        multiline\r\n                        rowsMax={10}\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"customStatus\"\r\n                        value={JSON.stringify(details.customStatus, null, 3)}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        multiline\r\n                        rowsMax={10}\r\n                    />\r\n                </Grid>\r\n            </Grid>\r\n\r\n        </>);\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Box, Button, Checkbox, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle,\r\n    FormControlLabel, TextField\r\n} from '@material-ui/core';\r\n\r\nimport { OrchestrationDetailsState } from '../states/OrchestrationDetailsState';\r\n\r\n// Buttons for detailed orchestration view\r\n@observer\r\nexport class OrchestrationButtons extends React.Component<{ state: OrchestrationDetailsState, disabled: boolean }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (<>\r\n\r\n            {this.renderDialogs(state)}\r\n\r\n            <Button variant=\"outlined\" color=\"primary\" size=\"medium\" disabled={this.props.disabled} onClick={() => state.restartDialogOpen = true}>\r\n                Restart\r\n            </Button>\r\n            <Box width={10} />\r\n            <Button variant=\"outlined\" color=\"primary\" size=\"medium\" disabled={this.props.disabled} onClick={() => state.rewindConfirmationOpen = true}>\r\n                Rewind\r\n            </Button>\r\n            <Box width={10} />\r\n            <Button variant=\"outlined\" color=\"primary\" size=\"medium\" disabled={this.props.disabled} onClick={() => state.terminateConfirmationOpen = true}>\r\n                Terminate\r\n            </Button>\r\n            <Box width={10} />\r\n            <Button variant=\"outlined\" color=\"primary\" size=\"medium\" disabled={this.props.disabled} onClick={() => state.raiseEventDialogOpen = true}>\r\n                Raise Event\r\n            </Button>\r\n            <Box width={10} />\r\n            <Button variant=\"outlined\" color=\"primary\" size=\"medium\" disabled={this.props.disabled} onClick={() => state.setCustomStatusDialogOpen = true}>\r\n                Set Custom Status\r\n            </Button>\r\n            <Box width={10} />\r\n            <Button variant=\"outlined\" color=\"primary\" size=\"medium\" disabled={this.props.disabled} onClick={() => state.purgeConfirmationOpen = true}>\r\n                Purge\r\n            </Button>            \r\n            \r\n        </>);\r\n    }\r\n\r\n    private renderDialogs(state: OrchestrationDetailsState): JSX.Element {\r\n        return (<>\r\n\r\n            <Dialog\r\n                open={state.rewindConfirmationOpen}\r\n                onClose={() => state.rewindConfirmationOpen = false}\r\n            >\r\n                <DialogTitle>Confirm Rewind</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        You're about to rewind orchestration '{state.orchestrationId}'. Are you sure?\r\n                    </DialogContentText>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => state.rewindConfirmationOpen = false} color=\"primary\" autoFocus>\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={() => state.rewind()} color=\"secondary\">\r\n                        Yes, rewind\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n                open={state.terminateConfirmationOpen}\r\n                onClose={() => state.terminateConfirmationOpen = false}\r\n            >\r\n                <DialogTitle>Confirm Terminate</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        You're about to terminate orchestration '{state.orchestrationId}'. This operation cannot be undone. Are you sure?\r\n                    </DialogContentText>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => state.terminateConfirmationOpen = false} color=\"primary\" autoFocus>\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={() => state.terminate()} color=\"secondary\">\r\n                        Yes, terminate\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n                fullWidth={true}\r\n                open={state.raiseEventDialogOpen}\r\n                onClose={() => state.raiseEventDialogOpen = false}\r\n            >\r\n                <DialogTitle>Raise Event</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        Provide event name and some additional data\r\n                    </DialogContentText>\r\n\r\n                    <TextField\r\n                        autoFocus\r\n                        margin=\"dense\"\r\n                        label=\"Event Name\"\r\n                        InputLabelProps={{ shrink: true }}\r\n                        fullWidth\r\n                        value={state.eventName}\r\n                        onChange={(evt) => state.eventName = evt.target.value as string}\r\n                    />\r\n\r\n                    <TextField\r\n                        margin=\"dense\"\r\n                        label=\"Event Data (JSON)\"\r\n                        InputLabelProps={{ shrink: true }}\r\n                        fullWidth\r\n                        multiline\r\n                        rows={7}\r\n                        value={state.eventData}\r\n                        onChange={(evt) => state.eventData = evt.target.value as string}\r\n                    />\r\n\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => state.raiseEventDialogOpen = false} color=\"primary\">\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={() => state.raiseEvent()} disabled={!state.eventName} color=\"secondary\">\r\n                        Raise\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n            \r\n            <Dialog\r\n                fullWidth={true}\r\n                open={state.setCustomStatusDialogOpen}\r\n                onClose={() => state.setCustomStatusDialogOpen = false}\r\n            >\r\n                <DialogTitle>Set customStatus</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        customStatus field is a way for external clients to differentiate instances of your orchestration. It does not affect the orchestration workflow itself.\r\n                    </DialogContentText>\r\n\r\n                    <TextField\r\n                        margin=\"dense\"\r\n                        InputLabelProps={{ shrink: true }}\r\n                        label=\"New customStatus (JSON)\"\r\n                        fullWidth\r\n                        multiline\r\n                        rows={10}\r\n                        value={state.newCustomStatus}\r\n                        onChange={(evt) => state.newCustomStatus = evt.target.value as string}\r\n                    />\r\n\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => state.setCustomStatusDialogOpen = false} color=\"primary\">\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={() => state.setCustomStatus()} disabled={!state.isCustomStatusDirty} color=\"secondary\">\r\n                        Apply\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n                open={state.purgeConfirmationOpen}\r\n                onClose={() => state.purgeConfirmationOpen = false}\r\n            >\r\n                <DialogTitle>Confirm Purge</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        You're about to purge orchestration '{state.orchestrationId}'. This operation drops orchestration state from the underlying storage and cannot be undone. Are you sure?\r\n                    </DialogContentText>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => state.purgeConfirmationOpen = false} color=\"primary\" autoFocus>\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={() => state.purge()} color=\"secondary\">\r\n                        Yes, purge\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n\r\n            <Dialog\r\n                open={state.restartDialogOpen}\r\n                onClose={() => state.restartDialogOpen = false}\r\n            >\r\n                <DialogTitle>Confirm Restart</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        You're about to restart orchestration '{state.orchestrationId}'. Are you sure?\r\n                    </DialogContentText>\r\n\r\n                    <FormControlLabel control={<Checkbox\r\n                        checked={state.restartWithNewInstanceId}\r\n                        onChange={(evt) => state.restartWithNewInstanceId = evt.target.checked} />}\r\n                        label=\"Restart with new instanceId\"\r\n                    />\r\n\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => state.restartDialogOpen = false} color=\"primary\" autoFocus>\r\n                        Cancel\r\n                    </Button>\r\n                    <Button onClick={() => state.restart()} color=\"secondary\">\r\n                        Restart\r\n                    </Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        </>);\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    FormHelperText, Grid, InputBase, Table, TableBody, TableCell, TableHead, TableRow, Typography, TextField\r\n} from '@material-ui/core';\r\n\r\nimport { DurableOrchestrationStatus, HistoryEventFields } from '../states/DurableOrchestrationStatus';\r\nimport { IBackendClient } from '../services/IBackendClient';\r\nimport { OrchestrationLink } from './OrchestrationLink';\r\n\r\n// Fields for detailed orchestration view\r\n@observer\r\nexport class OrchestrationFields extends React.Component<{ details: DurableOrchestrationStatus, backendClient: IBackendClient }> {\r\n\r\n    render(): JSX.Element {\r\n        const details = this.props.details;\r\n\r\n        return (<>\r\n            <Grid container className=\"grid-container\">\r\n                <Grid item xs={12} sm={12} md={3} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"name\"\r\n                        value={details.name}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={2} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"createdTime\"\r\n                        value={details.createdTime}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={2} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"lastUpdatedTime\"\r\n                        value={details.lastUpdatedTime}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={2} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"runtimeStatus\"\r\n                        value={details.runtimeStatus}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        className={!!details.runtimeStatus ? \"runtime-status-\" + details.runtimeStatus.toLowerCase() : \"\"}\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} sm={6} md={3} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"customStatus\"\r\n                        value={JSON.stringify(details.customStatus)}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"input\"\r\n                        value={JSON.stringify(details.input, null, 3)}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        multiline\r\n                        rowsMax={8}\r\n                    />\r\n                </Grid>\r\n                <Grid item xs={12} zeroMinWidth className=\"grid-item\">\r\n                    <TextField\r\n                        label=\"output\"\r\n                        value={JSON.stringify(details.output, null, 3)}\r\n                        margin=\"normal\"\r\n                        InputProps={{ readOnly: true }}\r\n                        InputLabelProps={{ shrink: true }}\r\n                        variant=\"outlined\"\r\n                        fullWidth\r\n                        multiline\r\n                        rowsMax={8}\r\n                    />\r\n                </Grid>\r\n            </Grid>\r\n\r\n            <FormHelperText className=\"history-events-count-label\">\r\n                historyEvents: {!!details.historyEvents ? details.historyEvents.length : 0} items\r\n            </FormHelperText>\r\n\r\n            {this.renderTable(details.historyEvents)}\r\n\r\n        </>);\r\n    }\r\n\r\n    private renderEmptyTable(): JSX.Element {\r\n        return (\r\n            <Typography variant=\"h5\" className=\"empty-table-placeholder\" >\r\n                This list is empty\r\n            </Typography>\r\n        );\r\n    }\r\n\r\n    private renderTable(events: Array<any> | undefined): JSX.Element {\r\n\r\n        if (!events || !events.length) {\r\n            return this.renderEmptyTable();\r\n        }\r\n\r\n        return (\r\n            <Table size=\"small\">\r\n                <TableHead>\r\n                    <TableRow>\r\n                        {HistoryEventFields.map(col => {\r\n                            return <TableCell key={col}>{col}</TableCell>;\r\n                        })}\r\n                    </TableRow>\r\n                </TableHead>\r\n                <TableBody>\r\n                    {events.map((event: any, index: number) => {\r\n\r\n                        const cellStyle = { verticalAlign: 'top' };\r\n                        return (\r\n                            <TableRow key={index}>\r\n                                <TableCell style={cellStyle}>\r\n                                    {event.Timestamp}\r\n                                </TableCell>\r\n                                <TableCell style={cellStyle}>\r\n                                    {event.EventType}\r\n                                </TableCell>\r\n                                <TableCell className=\"name-cell\" style={cellStyle}>\r\n\r\n                                    {!!event.SubOrchestrationId ?\r\n                                        (<OrchestrationLink\r\n                                            orchestrationId={event.SubOrchestrationId}\r\n                                            title={event.FunctionName}\r\n                                            backendClient={this.props.backendClient} />)\r\n                                        :\r\n                                        (event.Name ?? event.FunctionName)\r\n                                    }\r\n\r\n                                </TableCell>\r\n                                <TableCell style={cellStyle}>\r\n                                    {event.ScheduledTime}\r\n                                </TableCell>\r\n                                <TableCell className=\"long-text-cell\" style={cellStyle}>\r\n                                    <InputBase\r\n                                        className=\"long-text-cell-input\"\r\n                                        multiline fullWidth rowsMax={5} readOnly\r\n                                        value={JSON.stringify(event.Result)}\r\n                                    />\r\n                                </TableCell>\r\n                                <TableCell className=\"long-text-cell\" style={cellStyle}>\r\n                                    <InputBase\r\n                                        className=\"long-text-cell-input\"\r\n                                        multiline fullWidth rowsMax={5} readOnly\r\n                                        value={event.Details}\r\n                                    />\r\n                                </TableCell>\r\n                            </TableRow>\r\n                        );\r\n                    })}\r\n                </TableBody>\r\n            </Table>\r\n        );\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    AppBar, Box, Button, FormControl, InputLabel, LinearProgress, MenuItem, Paper,\r\n    Select, Tabs, Tab, TextField, Toolbar, Typography\r\n} from '@material-ui/core';\r\n\r\nimport RefreshIcon from '@material-ui/icons/Refresh';\r\nimport SaveIcon from '@material-ui/icons/Save';\r\n\r\nimport './OrchestrationDetails.css';\r\n\r\nimport { DurableEntityButtons } from './DurableEntityButtons';\r\nimport { DurableEntityFields } from './DurableEntityFields';\r\nimport { ErrorMessage } from './ErrorMessage';\r\nimport { OrchestrationButtons } from './OrchestrationButtons';\r\nimport { OrchestrationDetailsState } from '../states/OrchestrationDetailsState';\r\nimport { OrchestrationFields } from './OrchestrationFields';\r\nimport { IBackendClient } from '../services/IBackendClient';\r\n\r\n// Orchestration Details view\r\n@observer\r\nexport class OrchestrationDetails extends React.Component<{ state: OrchestrationDetailsState }> {\r\n\r\n    componentDidMount() {\r\n\r\n        // Triggering initial load\r\n        this.props.state.loadDetails();\r\n    }\r\n    \r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (<>\r\n            {state.inProgress ? (<LinearProgress />) : (<Box height={4} />)}\r\n           \r\n            <Toolbar variant=\"dense\" className=\"top-toolbar\">\r\n\r\n                {state.details.entityType === \"Orchestration\" && (\r\n                    <OrchestrationButtons state={state} disabled={state.inProgress} />\r\n                )}\r\n                {state.details.entityType === \"DurableEntity\" && (\r\n                    <DurableEntityButtons state={state} disabled={state.inProgress} />\r\n                )}\r\n                \r\n                <Box width={20} />\r\n                <Typography style={{ flex: 1 }} />\r\n\r\n                <FormControl>\r\n                    <InputLabel htmlFor=\"auto-refresh-select\">Auto-refresh</InputLabel>\r\n                    <Select\r\n                        className=\"toolbar-select\"\r\n                        value={state.autoRefresh}\r\n                        onChange={(evt) => state.autoRefresh = evt.target.value as number}\r\n                        inputProps={{ id: 'auto-refresh-select' }}>\r\n                        <MenuItem value={0}>Never</MenuItem>\r\n                        <MenuItem value={1}>Every 1 sec.</MenuItem>\r\n                        <MenuItem value={5}>Every 5 sec.</MenuItem>\r\n                        <MenuItem value={10}>Every 10 sec.</MenuItem>\r\n                    </Select>\r\n                </FormControl>\r\n\r\n                <Box width={20} />\r\n\r\n                <Button\r\n                    className=\"details-refresh-button\"\r\n                    variant=\"outlined\"\r\n                    color=\"default\"\r\n                    size=\"large\"\r\n                    disabled={state.inProgress}\r\n                    onClick={() => state.loadDetails()}\r\n                >\r\n                    <RefreshIcon />\r\n                </Button>\r\n\r\n            </Toolbar>\r\n\r\n            {!!state.tabStates.length && (<>\r\n                <AppBar color=\"inherit\" position=\"static\">\r\n                    <Tabs value={state.selectedTabIndex} onChange={(ev: React.ChangeEvent<{}>, val) => state.selectedTabIndex = val}>\r\n                        \r\n                        <Tab className=\"tab-title\" label=\"Details\" disabled={state.inProgress} />\r\n                        \r\n                        {state.tabStates.map(tabState => (\r\n                            <Tab className=\"tab-title\" key={tabState.name} label={tabState.name} disabled={state.inProgress} />\r\n                        ))}\r\n\r\n                    </Tabs>\r\n                </AppBar>\r\n            </>)}\r\n\r\n            {!state.selectedTabIndex && state.details.entityType === \"Orchestration\" &&\r\n                (<OrchestrationFields details={state.details} backendClient={state.backendClient} />)\r\n            }\r\n            {!state.selectedTabIndex && state.details.entityType === \"DurableEntity\" &&\r\n                <DurableEntityFields details={state.details} />\r\n            }\r\n\r\n            {!!state.selectedTab && !!state.selectedTab.rawHtml && (<>\r\n\r\n                <div className=\"raw-html-div\" dangerouslySetInnerHTML={{ __html: this.getStyledSvg(state.selectedTab.rawHtml) }} />\r\n                \r\n                {state.selectedTab.isMermaidDiagram && (\r\n\r\n                    <Toolbar variant=\"dense\">\r\n                        <TextField\r\n                            label=\"mermaid diagram code (for your reference)\"\r\n                            value={state.selectedTab.description}\r\n                            margin=\"normal\"\r\n                            InputProps={{ readOnly: true }}\r\n                            InputLabelProps={{ shrink: true }}\r\n                            variant=\"outlined\"\r\n                            fullWidth\r\n                            multiline\r\n                            rowsMax={4}\r\n                        />\r\n\r\n                        <Box width={20} />\r\n\r\n                        <SaveAsSvgButton\r\n                            svg={this.getStyledSvg(state.selectedTab.rawHtml)}\r\n                            orchestrationId={state.orchestrationId}\r\n                            inProgress={state.inProgress}\r\n                            backendClient={state.backendClient}\r\n                        />\r\n\r\n                    </Toolbar>\r\n                )}\r\n                \r\n            </>)}\r\n\r\n            <ErrorMessage state={this.props.state} />\r\n        </>);\r\n    }\r\n\r\n    // Appends some styling to SVG code, so it can also be saved as file\r\n    private getStyledSvg(svg: string): string {\r\n\r\n        return svg.replace('</style>',\r\n            '.note { stroke: none !important; fill: none !important; } ' +\r\n            '.noteText { font-size: 9px !important; } ' +\r\n            '</style>'\r\n        );\r\n    }\r\n}\r\n\r\nclass SaveAsSvgButton extends React.Component<{ svg: string, orchestrationId: string, inProgress: boolean, backendClient: IBackendClient }> {\r\n\r\n    render(): JSX.Element {\r\n\r\n        if (this.props.backendClient.isVsCode) {\r\n\r\n            return (\r\n                <Button\r\n                    variant=\"outlined\"\r\n                    color=\"default\"\r\n                    size=\"large\"\r\n                    className=\"save-svg-button\"\r\n                    disabled={this.props.inProgress}\r\n                    onClick={() => this.props.backendClient.call('SaveAs', this.props.orchestrationId + '.svg', this.props.svg)}\r\n                >\r\n                    <div>\r\n                        <SaveIcon />\r\n                        <Typography color=\"inherit\">Save as .SVG</Typography>\r\n                    </div>\r\n                </Button>\r\n            );\r\n\r\n        } else {\r\n\r\n            return (\r\n                <Button\r\n                    variant=\"outlined\"\r\n                    color=\"default\"\r\n                    size=\"large\"\r\n                    className=\"save-svg-button\"\r\n                    disabled={this.props.inProgress}\r\n                    href={URL.createObjectURL(new Blob([this.props.svg], { type: 'image/svg+xml' }))}\r\n                    download={this.props.orchestrationId + '.svg'}\r\n                >\r\n                    <div>\r\n                        <SaveIcon />\r\n                        <Typography color=\"inherit\">Save as .SVG</Typography>\r\n                    </div>\r\n                </Button>\r\n            );\r\n        }\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Box, Checkbox, Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle, FormControl,\r\n    FormControlLabel, FormGroup, FormLabel, LinearProgress, Radio, RadioGroup, Tooltip, Typography\r\n} from '@material-ui/core';\r\n\r\nimport { KeyboardDateTimePicker } from '@material-ui/pickers';\r\n\r\nimport './PurgeHistoryDialog.css';\r\n\r\nimport { DateTimeHelpers } from '../DateTimeHelpers';\r\nimport { ErrorMessage } from './ErrorMessage';\r\nimport { EntityType, RuntimeStatus } from '../states/DurableOrchestrationStatus';\r\nimport { PurgeHistoryDialogState } from '../states/PurgeHistoryDialogState';\r\n\r\n// Dialog with parameters for purging orchestration instance history\r\n@observer\r\nexport class PurgeHistoryDialog extends React.Component<{ state: PurgeHistoryDialogState }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (\r\n            <Dialog open={state.dialogOpen} onClose={() => { if (!state.inProgress) state.dialogOpen = false; }}>\r\n\r\n                <DialogTitle>Purge Instance History</DialogTitle>\r\n\r\n                {state.instancesDeleted === null && (\r\n                    <div>\r\n                        <DialogContent>\r\n\r\n                            {state.inProgress ? (<LinearProgress />) : (<Box height={4} />)}\r\n\r\n                            <DialogContentText>\r\n                                WARNING: this operation drops instance states from the underlying storage and cannot be undone.\r\n\r\n                                {state.entityType === \"DurableEntity\" && (\r\n                                    <Typography color=\"error\" >\r\n                                        It might as well remove Durable Entities, that are still active.\r\n                                        Ensure that you specify the correct time frame!\r\n                                        To clean up deleted Entities use the 'Clean Entity Storage' command instead. \r\n                                    </Typography>\r\n                                )}\r\n\r\n                            </DialogContentText>\r\n\r\n                            <FormControl className=\"purge-history-statuses\" disabled={state.inProgress} fullWidth>\r\n                                <FormLabel>Apply to:</FormLabel>\r\n                                <RadioGroup row\r\n                                    value={state.entityType}\r\n                                    onChange={(evt) => state.entityType = (evt.target as HTMLInputElement).value as EntityType}\r\n                                >\r\n                                    <FormControlLabel\r\n                                        disabled={state.inProgress}\r\n                                        value={\"Orchestration\"}\r\n                                        control={<Radio />}\r\n                                        label=\"Orchestrations\"\r\n                                    />\r\n                                    <FormControlLabel\r\n                                        disabled={state.inProgress}\r\n                                        value={\"DurableEntity\"}\r\n                                        control={<Radio />}\r\n                                        label=\"Durable Entities\"\r\n                                    />\r\n                                </RadioGroup>\r\n                            </FormControl>\r\n\r\n                            <KeyboardDateTimePicker\r\n                                className=\"purge-history-from-input\"\r\n                                ampm={false}\r\n                                autoOk={true}\r\n                                label={state.entityType === 'DurableEntity' ? 'Last Updated From (UTC)' : 'From (UTC)'}\r\n                                format={\"YYYY-MM-DD HH:mm:ss\"}\r\n                                variant=\"inline\"\r\n                                disabled={state.inProgress}\r\n                                value={state.timeFrom}\r\n                                onChange={(t) => state.timeFrom = DateTimeHelpers.momentAsUtc(t)}\r\n                            />\r\n\r\n                            <KeyboardDateTimePicker\r\n                                className=\"purge-history-till-input\"\r\n                                ampm={false}\r\n                                autoOk={true}\r\n                                label={state.entityType === 'DurableEntity' ? 'Last Updated Till (UTC)' : 'Till (UTC)'}\r\n                                format={\"YYYY-MM-DD HH:mm:ss\"}\r\n                                variant=\"inline\"\r\n                                disabled={state.inProgress}\r\n                                value={state.timeTill}\r\n                                onChange={(t) => state.timeTill = DateTimeHelpers.momentAsUtc(t)}\r\n                            />\r\n\r\n                            <FormControl className=\"purge-history-statuses\" disabled={state.inProgress}>\r\n                                <FormLabel>With the following status:</FormLabel>\r\n\r\n                                {state.entityType === 'Orchestration' && (\r\n                                    <FormGroup row>\r\n                                        <RuntimeStatusCheckbox state={state} runtimeStatus=\"Completed\" />\r\n                                        <RuntimeStatusCheckbox state={state} runtimeStatus=\"Failed\" />\r\n                                        <RuntimeStatusCheckbox state={state} runtimeStatus=\"Terminated\" />\r\n                                    </FormGroup>\r\n                                )}\r\n\r\n                                {state.entityType === 'DurableEntity' && (\r\n                                    <FormGroup row>\r\n                                        <Tooltip title=\"Durable Entities are always in 'Running' state\">\r\n                                            <FormControlLabel\r\n                                                control={<Checkbox\r\n                                                    checked={true} />}\r\n                                                label=\"Running\"\r\n                                                disabled={true}\r\n                                            />\r\n                                        </Tooltip>\r\n                                    </FormGroup>\r\n                                )}\r\n                            </FormControl>\r\n\r\n                            <ErrorMessage state={state} />\r\n\r\n                        </DialogContent>\r\n                        <DialogActions>\r\n                            <Button onClick={() => state.dialogOpen = false} disabled={state.inProgress} color=\"primary\">\r\n                                Cancel\r\n                            </Button>\r\n                            <Button onClick={() => state.purgeHistory()} disabled={!state.isValid || state.inProgress} color=\"secondary\">\r\n                                Purge\r\n                            </Button>\r\n                        </DialogActions>\r\n                    </div>\r\n                )}\r\n\r\n                {state.instancesDeleted !== null && (\r\n                    <div>\r\n                        <DialogContent>\r\n                            <DialogContentText className=\"success-message\">\r\n                                {state.instancesDeleted} instances were deleted.\r\n                            </DialogContentText>\r\n                        </DialogContent>\r\n                        <DialogActions>\r\n                            <Button onClick={() => state.dialogOpen = false} color=\"primary\">\r\n                                Close\r\n                            </Button>\r\n                        </DialogActions>\r\n                    </div>\r\n                )}\r\n\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\n@observer\r\nclass RuntimeStatusCheckbox extends React.Component<{ state: PurgeHistoryDialogState, runtimeStatus: RuntimeStatus }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n        const runtimeStatus = this.props.runtimeStatus;\r\n\r\n        return (\r\n            <FormControlLabel\r\n                control={<Checkbox\r\n                    checked={state.getStatusIncluded(runtimeStatus)}\r\n                    onChange={(evt) => state.setStatusIncluded(runtimeStatus, evt.target.checked)} />}\r\n                label={runtimeStatus}\r\n            />\r\n        );\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport {\r\n    Box, Checkbox, Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle, FormControl,\r\n    FormControlLabel, FormGroup, LinearProgress, \r\n} from '@material-ui/core';\r\n\r\nimport './CleanEntityStorageDialog.css';\r\n\r\nimport { ErrorMessage } from './ErrorMessage';\r\nimport { CleanEntityStorageDialogState } from '../states/CleanEntityStorageDialogState';\r\n\r\n// Dialog with parameters for cleaning entity storage\r\n@observer\r\nexport class CleanEntityStorageDialog extends React.Component<{ state: CleanEntityStorageDialogState }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (\r\n            <Dialog open={state.dialogOpen} onClose={() => { if (!state.inProgress) state.dialogOpen = false; }}>\r\n\r\n                <DialogTitle>Clean Entity Storage</DialogTitle>\r\n\r\n                {!state.response && (<>\r\n                    <DialogContent>\r\n\r\n                        {state.inProgress ? (<LinearProgress />) : (<Box height={4} />)}\r\n\r\n                        <DialogContentText>\r\n                            An entity is considered empty, and is removed, if it has no state, is not locked, and has been idle for more than EntityMessageReorderWindowInMinutes. Locks are considered orphaned, and are released, if the orchestration that holds them is not in state Running.\r\n                        </DialogContentText>\r\n\r\n                        <FormControl className=\"purge-history-statuses\" disabled={state.inProgress}>\r\n                            <FormGroup row>\r\n\r\n                                <FormControlLabel control={<Checkbox\r\n                                    checked={state.removeEmptyEntities}\r\n                                    onChange={(evt) => state.removeEmptyEntities = evt.target.checked} />}\r\n                                    label=\"Remove Empty Entities\"\r\n                                />\r\n\r\n                                <FormControlLabel control={<Checkbox\r\n                                    checked={state.releaseOrphanedLocks}\r\n                                    onChange={(evt) => state.releaseOrphanedLocks = evt.target.checked} />}\r\n                                    label=\"Release Orphaned Locks\"\r\n                                />\r\n                                \r\n                            </FormGroup>\r\n                        </FormControl>\r\n\r\n                        <ErrorMessage state={state} />\r\n\r\n                    </DialogContent>\r\n\r\n                    <DialogActions>\r\n                        <Button onClick={() => state.dialogOpen = false} disabled={state.inProgress} color=\"primary\">\r\n                            Cancel\r\n                        </Button>\r\n                        <Button onClick={() => state.clean()} disabled={!state.isValid || state.inProgress} color=\"secondary\">\r\n                            Clean\r\n                        </Button>\r\n                    </DialogActions>\r\n                </>)}\r\n\r\n                {!!state.response && (<>\r\n                    <DialogContent>\r\n                        <DialogContentText className=\"success-message\">\r\n                            {state.response.numberOfEmptyEntitiesRemoved} empty entities removed. \r\n                        </DialogContentText>\r\n                        <DialogContentText className=\"success-message\">\r\n                            {state.response.numberOfOrphanedLocksRemoved} orphaned locks removed.\r\n                        </DialogContentText>\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <Button onClick={() => state.dialogOpen = false} color=\"primary\">\r\n                            Close\r\n                        </Button>\r\n                    </DialogActions>\r\n                </>)}\r\n\r\n            </Dialog>\r\n        );\r\n    }\r\n}","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\n\r\nimport { AppBar, Breadcrumbs, Box, Link, TextField, Toolbar, Typography } from '@material-ui/core';\r\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers';\r\nimport Autocomplete from '@material-ui/lab/Autocomplete';\r\nimport MomentUtils from '@date-io/moment';\r\n\r\nimport './Main.css';\r\n\r\nimport { LoginIcon } from './LoginIcon';\r\nimport { MainMenu } from './MainMenu';\r\nimport { MainState } from '../states/MainState';\r\nimport { Orchestrations } from './Orchestrations';\r\nimport { OrchestrationDetails } from './OrchestrationDetails';\r\nimport { PurgeHistoryDialog } from './PurgeHistoryDialog';\r\nimport { CleanEntityStorageDialog } from './CleanEntityStorageDialog';\r\n\r\nconst logo = require('../logo.svg');\r\n\r\n// The main application view\r\n@observer\r\nexport class Main extends React.Component<{ state: MainState }> {\r\n\r\n    render(): JSX.Element {\r\n        const state = this.props.state;\r\n\r\n        return (\r\n            <MuiPickersUtilsProvider utils={MomentUtils}><>\r\n\r\n                {!state.loginState && (\r\n                    <Box height={20}/>\r\n                )}\r\n                \r\n                {!!state.loginState && (\r\n                    <AppBar position=\"static\" color=\"default\" className=\"app-bar\">\r\n                        <Toolbar>\r\n\r\n                            {state.loginState.isLoggedIn && !!state.mainMenuState && (\r\n                                <MainMenu state={state.mainMenuState} />\r\n                            )}\r\n\r\n                            <img src={logo} width=\"30px\"></img>\r\n                            <Box width={5} />\r\n\r\n                            <Typography variant=\"h6\" color=\"inherit\" className=\"title-typography\">\r\n                                Durable Functions Monitor\r\n                            </Typography>\r\n\r\n                            <Breadcrumbs color=\"inherit\">\r\n                                <Link color=\"inherit\" href=\"/\">\r\n                                    / instances\r\n                                </Link>\r\n\r\n                                {!state.orchestrationDetailsState ?\r\n                                    (\r\n                                        <Autocomplete\r\n                                            className=\"instance-id-input\"\r\n                                            freeSolo\r\n                                            options={state.isExactMatch ? [] : state.suggestions}\r\n                                            value={state.typedInstanceId}\r\n                                            onChange={(evt, newValue) => {\r\n                                                state.typedInstanceId = newValue ?? '';\r\n                                                if (!!newValue) {\r\n                                                    state.goto();\r\n                                                }\r\n                                            }}\r\n                                            renderInput={(params) => (\r\n                                                <TextField\r\n                                                    {...params}\r\n                                                    className={state.isExactMatch ? 'instance-id-valid' : null}\r\n                                                    size=\"small\"\r\n                                                    label=\"instanceId to go to...\"\r\n                                                    variant=\"outlined\"\r\n                                                    onChange={(evt) => state.typedInstanceId = evt.target.value as string}\r\n                                                    onKeyPress={(evt) => this.handleKeyPress(evt)}\r\n                                                />\r\n                                            )}\r\n                                        />\r\n                                    )\r\n                                    :\r\n                                    (<Typography color=\"inherit\">\r\n                                        {state.orchestrationDetailsState.orchestrationId}\r\n                                    </Typography>)\r\n                                }\r\n\r\n                            </Breadcrumbs>\r\n\r\n                            <Typography style={{ flex: 1 }} />\r\n\r\n                            <LoginIcon state={state.loginState} />\r\n                        </Toolbar>\r\n                    </AppBar>\r\n                )}\r\n\r\n                {!!state.orchestrationsState && (!state.loginState || state.loginState.isLoggedIn) && (\r\n                    <Orchestrations state={state.orchestrationsState} />\r\n                )}\r\n\r\n                {!!state.orchestrationDetailsState && (!state.loginState || state.loginState.isLoggedIn) && (\r\n                    <OrchestrationDetails state={state.orchestrationDetailsState} />\r\n                )}\r\n\r\n                <PurgeHistoryDialog state={state.purgeHistoryDialogState}/>\r\n                <CleanEntityStorageDialog state={state.cleanEntityStorageDialogState} />\r\n\r\n            </></MuiPickersUtilsProvider>\r\n        );\r\n    }\r\n\r\n    private handleKeyPress(event: React.KeyboardEvent<HTMLDivElement>) {\r\n        if (event.key === 'Enter') {\r\n            // Otherwise the event will bubble up and the form will be submitted\r\n            event.preventDefault();\r\n\r\n            this.props.state.goto();\r\n        }\r\n    }\r\n}","import axios, { Method } from 'axios';\r\nimport { IBackendClient } from './IBackendClient';\r\n\r\nexport const BackendUri = process.env.REACT_APP_BACKEND_BASE_URI + process.env.REACT_APP_BACKEND_PATH;\r\n\r\n// Common IBackendClient implementation, sends HTTP requests directly\r\nexport class BackendClient implements IBackendClient {\r\n\r\n    get isVsCode(): boolean { return false; }\r\n\r\n    constructor(private _getAuthorizationHeaderAsync: () => Promise<{ Authorization: string }>) {\r\n    }\r\n\r\n    call(method: Method, url: string, data?: any): Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n\r\n            this._getAuthorizationHeaderAsync().then(headers => {\r\n\r\n                axios.request({\r\n                    url: BackendUri + url,\r\n                    method, data, headers\r\n                }).then(r => { resolve(r.data); }, reject);\r\n            });\r\n        });\r\n    }\r\n}","import { observable, computed } from 'mobx'\r\nimport axios, { AxiosResponse } from 'axios';\r\nimport * as Msal from 'msal';\r\n\r\nimport { ErrorMessageState } from './ErrorMessageState';\r\nimport { BackendUri } from '../services/BackendClient';\r\n\r\n// Login State\r\nexport class LoginState extends ErrorMessageState {\r\n\r\n    @computed\r\n    get isLoggedIn(): boolean { return this._isLoggedIn; };\r\n\r\n    @computed\r\n    get isLoggedInAnonymously(): boolean { return !this._userName; };\r\n\r\n    @computed\r\n    get userName(): string { return this._userName; };\r\n\r\n    @observable\r\n    menuAnchorElement?: Element;\r\n\r\n    constructor(private _rootUri: string) {\r\n        super();\r\n        this.login();\r\n    }\r\n\r\n    login() {\r\n        const uri = `${BackendUri}/easyauth-config`;\r\n        axios.get(uri).then(response => this.loginWithEasyAuthConfig(response), err => {\r\n            this.errorMessage = `${err.message}.${(!!err.response ? err.response.data : '')}`;\r\n        });\r\n    }\r\n\r\n    logout() {\r\n        this.menuAnchorElement = undefined;\r\n        this._aadApp.logout();\r\n    }\r\n\r\n    getAuthorizationHeaderAsync() {\r\n\r\n        // Let's think we're on localhost and proceed with no auth\r\n        if (!this._aadApp) {\r\n            return new Promise<undefined>((resolve, reject) => resolve(undefined));\r\n        }\r\n\r\n        return new Promise<{ Authorization: string }>((resolve, reject) => {\r\n            // Obtaining a token to access our own AAD app\r\n            const authParams: Msal.AuthenticationParameters = {\r\n                scopes: [this._aadApp.getCurrentConfiguration().auth.clientId]\r\n            };\r\n\r\n            this._aadApp.acquireTokenSilent(authParams)\r\n                .then((authResponse) => {\r\n\r\n                    var accessToken = authResponse.accessToken;\r\n                    if (!accessToken) {\r\n                        // https://github.com/AzureAD/microsoft-authentication-library-for-js/issues/736\r\n                        // accessToken might randomly be returned as null, in which case we can probably use id_token\r\n                        // (which is supposed to be the same)\r\n                        console.log('DFM: accessToken is null, so using idToken.rawIdToken instead');\r\n                        accessToken = authResponse.idToken.rawIdToken;\r\n                    }\r\n\r\n                    resolve({ Authorization: `Bearer ${accessToken}` });\r\n\r\n                }, err => {\r\n                    // If silent token aquiring failed, then just redirecting the user back to AAD, \r\n                    // so that the page is reloaded anyway.\r\n                    // This is supposed to happen very rarely, as default refresh token lifetime is quite long.  \r\n                    console.log(`DFM: acquireTokenSilent() failed (${err}), so calling acquireTokenRedirect()...`);\r\n                    this._aadApp.acquireTokenRedirect(authParams);\r\n                });\r\n        });\r\n    }\r\n\r\n    @observable\r\n    private _isLoggedIn: boolean = false;\r\n\r\n    @observable\r\n    private _userName: string;\r\n\r\n    private _aadApp: Msal.UserAgentApplication;\r\n\r\n    private loginWithEasyAuthConfig(easyAuthConfigResponse: AxiosResponse<any>) {\r\n\r\n        const config = easyAuthConfigResponse.data;\r\n        if (!config.clientId) {\r\n            // Let's think we're on localhost and proceed with no auth\r\n            this._isLoggedIn = true;\r\n            return;\r\n        }\r\n\r\n        // Configuring MSAL with values received from backend\r\n        this._aadApp = new Msal.UserAgentApplication({\r\n            auth: {\r\n                clientId: config.clientId,\r\n                authority: config.authority,\r\n                redirectUri: this._rootUri\r\n            }\r\n        })\r\n\r\n        // Checking if it was a redirect from AAD\r\n        this._aadApp.handleRedirectCallback(() => { }, (authErr: Msal.AuthError, accountState: string) => {\r\n\r\n            console.log(`Failed to handle login redirect. name: ${authErr.name}, message: ${authErr.message}, errorCode: ${authErr.errorCode}, errorMessage: ${authErr.errorMessage}, accountState: ${accountState}`);\r\n        });\r\n\r\n        const account = this._aadApp.getAccount();\r\n\r\n        if (!account) {\r\n            // Redirecting user to AAD. Redirect flow is more reliable (doesn't need popups enabled)\r\n            this._aadApp.loginRedirect();\r\n\r\n        } else {\r\n            // We've logged in successfully. Setting user name.\r\n            this._userName = account.userName;\r\n            this._isLoggedIn = true;\r\n        }\r\n    }\r\n}","import { observable, computed } from 'mobx'\r\n\r\nimport { ErrorMessageState } from './ErrorMessageState';\r\nimport { IBackendClient } from '../services/IBackendClient';\r\nimport { PurgeHistoryDialogState } from './PurgeHistoryDialogState';\r\nimport { CleanEntityStorageDialogState } from './CleanEntityStorageDialogState';\r\n\r\n// State of Main Menu component\r\nexport class MainMenuState extends ErrorMessageState {\r\n\r\n    @observable\r\n    menuAnchorElement?: Element;\r\n\r\n    @observable\r\n    hubName: string;\r\n    @observable\r\n    connectionString: string;\r\n    \r\n    @observable\r\n    connectionParamsDialogOpen: boolean = false;\r\n\r\n    @computed\r\n    get inProgress(): boolean { return this._inProgress; }\r\n\r\n    @computed\r\n    get isReadonly(): boolean { return this._isReadOnly; }\r\n\r\n    @computed\r\n    get isDirty(): boolean {\r\n        return (this.connectionString !== this._oldConnectionString) || (this.hubName !== this._oldHubName);\r\n    }\r\n\r\n    constructor(private _backendClient: IBackendClient,\r\n        private _purgeHistoryDialogState: PurgeHistoryDialogState,\r\n        private _cleanEntityStorageDialogState: CleanEntityStorageDialogState) {\r\n        super();\r\n    }\r\n    \r\n    showConnectionParamsDialog() {\r\n        this.menuAnchorElement = undefined;\r\n\r\n        this.connectionParamsDialogOpen = true;\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('GET', '/manage-connection').then(response => {\r\n\r\n            this.connectionString = this._oldConnectionString = response.connectionString;\r\n            this.hubName = this._oldHubName = response.hubName;\r\n            this._isReadOnly = response.isReadOnly;\r\n\r\n        }, err => {\r\n            this.errorMessage = `Load failed: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        }).finally(() => {\r\n            this._inProgress = false;\r\n        });\r\n    }\r\n\r\n    saveConnectionParams() {\r\n\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('PUT', '/manage-connection', {\r\n            connectionString: this.connectionString !== this._oldConnectionString ? this.connectionString : '',\r\n            hubName: this.hubName\r\n        }).then(() => {\r\n        \r\n            this.connectionParamsDialogOpen = false;\r\n\r\n            alert(`Your changes were saved to local.settings.json file, but they cannot be picked up automatically. Please, restart the Function Host for them to take effect.`);\r\n\r\n        }, err => {\r\n            this.errorMessage = `Save failed: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        }).finally(() => {\r\n            this._inProgress = false;\r\n        });\r\n    }\r\n\r\n    showPurgeHistoryDialog() {\r\n        this.menuAnchorElement = undefined;\r\n        \r\n        this._purgeHistoryDialogState.dialogOpen = true;\r\n    }\r\n\r\n    showCleanEntityStorageDialog() {\r\n        this.menuAnchorElement = undefined;\r\n\r\n        this._cleanEntityStorageDialogState.dialogOpen = true;\r\n    }\r\n\r\n    setWindowTitle() {\r\n        \r\n        this._backendClient.call('GET', '/about').then(response => {\r\n            document.title = `Durable Functions Monitor (${response.accountName}/${response.hubName}) v${response.version}`;\r\n        });\r\n    }\r\n\r\n    @observable\r\n    private _inProgress: boolean = false;\r\n\r\n    @observable\r\n    private _isReadOnly: boolean = false;\r\n    \r\n    private _oldConnectionString: string;\r\n    private _oldHubName: string;\r\n}","import { observable, computed } from 'mobx';\r\nimport mermaid from 'mermaid';\r\n\r\nimport { ICustomTabState } from './ICustomTabState';\r\nimport { DurableOrchestrationStatus } from '../states/DurableOrchestrationStatus';\r\n\r\n// Base class for all mermaid diagram tab states\r\nexport abstract class MermaidDiagramTabState implements ICustomTabState {\r\n\r\n    readonly name: string = \"Diagram\";\r\n    readonly isMermaidDiagram: boolean = true;\r\n\r\n    @computed\r\n    get description(): string { return this._diagramCode; };\r\n\r\n    @computed\r\n    get rawHtml(): string { return this._diagramSvg; };\r\n\r\n    constructor(protected _loadDetails: (orchestrationId: string) => Promise<DurableOrchestrationStatus>) {\r\n    }\r\n\r\n    load(details: DurableOrchestrationStatus) : Promise<void> {\r\n\r\n        // Only doing this on demand, just in case\r\n        if (!MermaidDiagramTabState._mermaidInitialized) {\r\n\r\n            mermaid.initialize({\r\n                startOnLoad: true,\r\n                sequence: {\r\n                    noteMargin: 0,\r\n                    boxMargin: 5,\r\n                    boxTextMargin: 5\r\n                }\r\n            });\r\n            MermaidDiagramTabState._mermaidInitialized = true;\r\n        }\r\n\r\n        if (!details.historyEvents) {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        return this.buildDiagram(details);\r\n    }\r\n\r\n    @observable\r\n    protected _diagramCode: string;\r\n    @observable\r\n    protected _diagramSvg: string;\r\n\r\n    private static _mermaidInitialized = false;\r\n\r\n    protected abstract buildDiagram(details: DurableOrchestrationStatus): Promise<void>;\r\n\r\n    protected formatDuration(durationInMs: number): string {\r\n\r\n        var result = '';\r\n        if (isNaN(durationInMs) || (durationInMs < 0)) {\r\n            return result;\r\n        }\r\n\r\n        const days = Math.floor(durationInMs / 86400000);\r\n        if (days > 30) {\r\n            // something went wrong...\r\n            return result;\r\n        }\r\n\r\n        if (days > 0) {\r\n            result += days.toFixed(0) + 'd';\r\n            durationInMs = durationInMs % 86400000;\r\n        }\r\n\r\n        const hours = Math.floor(durationInMs / 3600000);\r\n        if (hours > 0) {\r\n            result += hours.toFixed(0) + 'h';\r\n            durationInMs = durationInMs % 3600000;\r\n        }\r\n\r\n        const minutes = Math.floor(durationInMs / 60000);\r\n        if (minutes > 0) {\r\n            result += minutes.toFixed(0) + 'm';\r\n            durationInMs = durationInMs % 60000;\r\n        }\r\n\r\n        const seconds = Math.floor(durationInMs / 1000);\r\n        if (seconds > 0) {\r\n            result += seconds.toFixed(0) + 's';\r\n            durationInMs = durationInMs % 1000;\r\n        }\r\n\r\n        if (durationInMs > 0) {\r\n            result += durationInMs.toFixed(0) + 'ms';\r\n        }\r\n\r\n        return '(' + result + ')';\r\n    }\r\n}","import mermaid from 'mermaid';\r\n\r\nimport { DurableOrchestrationStatus, HistoryEvent } from '../states/DurableOrchestrationStatus';\r\nimport { MermaidDiagramTabState } from './MermaidDiagramTabState';\r\n\r\n// State of Sequence Diagram tab on OrchestrationDetails view\r\nexport class SequenceDiagramTabState extends MermaidDiagramTabState {\r\n\r\n    readonly name: string = \"Sequence Diagram\";\r\n\r\n    constructor(loadDetails: (orchestrationId: string) => Promise<DurableOrchestrationStatus>) {\r\n        super(loadDetails);\r\n    }\r\n\r\n    protected buildDiagram(details: DurableOrchestrationStatus) : Promise<void> {\r\n\r\n        return new Promise<void>((resolve, reject) => {\r\n            Promise.all(this.getSequenceForOrchestration(details.name, '.', details.historyEvents)).then(sequenceLines => {\r\n\r\n                this._diagramCode = 'sequenceDiagram \\n' + sequenceLines.join('');\r\n\r\n                try {\r\n\r\n                    // Very much unknown, why this line is needed. Without it sometimes the diagrams fail to re-render\r\n                    this._diagramSvg = '';\r\n\r\n                    mermaid.render('mermaidSvgId', this._diagramCode, (svg) => {\r\n                        this._diagramSvg = svg;\r\n                        resolve();\r\n                    });\r\n                    \r\n                } catch (err) {\r\n                    reject(err);\r\n                }\r\n\r\n            }, reject);\r\n        });\r\n    }\r\n\r\n    private getSequenceForOrchestration(orchestrationName: string,\r\n        parentOrchestrationName: string,\r\n        historyEvents: HistoryEvent[]): Promise<string>[] {\r\n\r\n        const externalActor = '.'\r\n        const results: Promise<string>[] = [];\r\n\r\n        var i = 0;\r\n        while (i < historyEvents.length) {\r\n            const event = historyEvents[i];\r\n\r\n            switch (event.EventType) {\r\n                case 'ExecutionStarted':\r\n\r\n                    var nextLine =\r\n                        `${parentOrchestrationName}->>+${orchestrationName}:[ExecutionStarted] \\n` +\r\n                        `Note over ${parentOrchestrationName},${orchestrationName}: ${this.formatDateTime(event.Timestamp)} \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n\r\n                    break;\r\n                case 'SubOrchestrationInstanceCompleted':\r\n\r\n                    if (!!event.SubOrchestrationId) {\r\n\r\n                        const subOrchestrationName = event.FunctionName;\r\n\r\n                        results.push(new Promise<string>((resolve, reject) => {\r\n                            this._loadDetails(event.SubOrchestrationId).then(details => {\r\n\r\n                                Promise.all(this.getSequenceForOrchestration(details.name, orchestrationName, details.historyEvents)).then(sequenceLines => {\r\n\r\n                                    resolve(sequenceLines.join(''));\r\n\r\n                                }, reject);\r\n\r\n                            }, err => {\r\n\r\n                                console.log(`Failed to load ${subOrchestrationName}. ${err.message}`);\r\n                                resolve(`${orchestrationName}-x${subOrchestrationName}:[FailedToLoad] \\n`);\r\n                            });\r\n                        }));\r\n                    }\r\n\r\n                    break;\r\n                case 'SubOrchestrationInstanceFailed':\r\n\r\n                    var nextLine = `${orchestrationName}-x${event.FunctionName}:[SubOrchestrationInstanceFailed] \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n                    break;\r\n                case 'TaskCompleted':\r\n\r\n                    // Trying to aggregate multiple parallel calls\r\n                    var maxDurationInMs = event.DurationInMs;\r\n                    var j = i + 1;\r\n                    for (; j < historyEvents.length &&\r\n                        historyEvents[j].EventType === 'TaskCompleted' &&\r\n                        historyEvents[j].FunctionName === event.FunctionName &&\r\n                        historyEvents[j].ScheduledTime.substr(0, 23) === event.ScheduledTime.substr(0, 23);\r\n                        j++) {\r\n\r\n                        if (maxDurationInMs < historyEvents[j].DurationInMs) {\r\n                            maxDurationInMs = historyEvents[j].DurationInMs;\r\n                        }\r\n                    }\r\n\r\n                    if (j === i + 1) {\r\n\r\n                        const nextLine =\r\n                            `${orchestrationName}->>${orchestrationName}:${event.FunctionName} \\n` +\r\n                            `Note over ${orchestrationName}: ${this.formatDuration(event.DurationInMs)} \\n`;\r\n                        results.push(Promise.resolve(nextLine));\r\n                        \r\n                    } else {\r\n\r\n                        const nextLine =\r\n                            `par ${j - i} calls \\n` +\r\n                            `${orchestrationName}->>${orchestrationName}:${event.FunctionName} \\n` +\r\n                            `Note over ${orchestrationName}: ${this.formatDuration(maxDurationInMs)} \\n` +\r\n                            `end \\n`;\r\n                        results.push(Promise.resolve(nextLine));\r\n\r\n                        i = j - 1;\r\n                    }\r\n\r\n                    break;\r\n                case 'TaskFailed':\r\n\r\n                    var nextLine = `${orchestrationName}-x${orchestrationName}:${event.FunctionName}(failed) \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n                    break;\r\n                case 'EventRaised':\r\n\r\n                    var nextLine =\r\n                        `${externalActor}->>${orchestrationName}:${event.Name} \\n` +\r\n                        `Note over ${externalActor},${orchestrationName}: ${this.formatDateTime(event.Timestamp)} \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n\r\n                    break;\r\n                case 'TimerFired':\r\n\r\n                    var nextLine =\r\n                        `${externalActor}->>${orchestrationName}:[TimerFired] \\n` +\r\n                        `Note over ${externalActor},${orchestrationName}: ${this.formatDateTime(event.Timestamp)} \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n\r\n                    break;\r\n                case 'ExecutionTerminated':\r\n\r\n                    var nextLine =\r\n                        `${externalActor}->>${orchestrationName}:[ExecutionTerminated] \\n` +\r\n                        `Note over ${externalActor},${orchestrationName}: ${this.formatDateTime(event.Timestamp)} \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n\r\n                    break;\r\n                case 'ExecutionCompleted':\r\n\r\n                    var nextLine =\r\n                        `${orchestrationName}-->>-${parentOrchestrationName}:[ExecutionCompleted] \\n` +\r\n                        `Note over ${orchestrationName},${parentOrchestrationName}: ${this.formatDuration(event.DurationInMs)} \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n\r\n                    break;\r\n            }\r\n\r\n            i++;\r\n        }\r\n\r\n        return results;\r\n    }\r\n\r\n    private formatDateTime(timestamp: string): string {\r\n        if (timestamp.length <= 11) {\r\n            return timestamp;\r\n        }\r\n        return '(' + timestamp.substr(11, 12) + 'Z)';\r\n    }\r\n}","import mermaid from 'mermaid';\r\n\r\nimport { DurableOrchestrationStatus, HistoryEvent } from '../states/DurableOrchestrationStatus';\r\nimport { MermaidDiagramTabState } from './MermaidDiagramTabState';\r\n\r\n// State of Gantt Diagram tab on OrchestrationDetails view\r\nexport class GanttDiagramTabState extends MermaidDiagramTabState {\r\n\r\n    readonly name: string = \"Gantt Diagram\";\r\n\r\n    constructor(loadDetails: (orchestrationId: string) => Promise<DurableOrchestrationStatus>) {\r\n        super(loadDetails);\r\n    }\r\n\r\n    protected buildDiagram(details: DurableOrchestrationStatus): Promise<void> {\r\n\r\n        return new Promise<void>((resolve, reject) => {\r\n            Promise.all(this.renderOrchestration(details.instanceId, details.name, true, details.historyEvents)).then(sequenceLines => {\r\n\r\n                this._diagramCode = 'gantt \\n' +\r\n                    `title ${details.name}(${details.instanceId}) \\n` +\r\n                    'dateFormat YYYY-MM-DDTHH:mm:ss.SSS \\n' +\r\n                    sequenceLines.join('');\r\n\r\n                // Very much unknown, why this line is needed. Without it sometimes the diagrams fail to re-render\r\n                this._diagramSvg = '';\r\n\r\n                try {\r\n\r\n                    mermaid.render('mermaidSvgId', this._diagramCode, (svg) => {\r\n                        this._diagramSvg = svg;\r\n                        resolve();\r\n                    });\r\n                    \r\n                } catch (err) {\r\n                    reject(err);\r\n                }\r\n\r\n            }, reject);\r\n        });\r\n    }\r\n\r\n    private renderOrchestration( orchestrationId: string,\r\n        orchestrationName: string,\r\n        isParentOrchestration: boolean,\r\n        historyEvents: HistoryEvent[]): Promise<string>[] {\r\n\r\n        const results: Promise<string>[] = [];\r\n\r\n        const startedEvent = historyEvents.find(event => event.EventType == 'ExecutionStarted');\r\n        const completedEvent = historyEvents.find(event => event.EventType == 'ExecutionCompleted');\r\n\r\n        var longerThanADay = false;\r\n        if (!!startedEvent && !!completedEvent) {\r\n\r\n            longerThanADay = completedEvent.DurationInMs > 86400000;\r\n            \r\n            var nextLine = isParentOrchestration ? '' : `section ${orchestrationName}(${this.escapeOrchestrationId(orchestrationId)}) \\n`;\r\n\r\n            var lineName = this.formatDuration(completedEvent.DurationInMs);\r\n            if (!lineName) {\r\n                lineName = orchestrationName;\r\n            }\r\n\r\n            nextLine += `${lineName}: ${isParentOrchestration ? '' : 'active,'} ${this.formatDateTime(startedEvent.Timestamp)}, ${this.formatDurationInSeconds(completedEvent.DurationInMs)} \\n`;\r\n            results.push(Promise.resolve(nextLine));\r\n        }\r\n\r\n        // setting axis format\r\n        if (isParentOrchestration) {\r\n\r\n            var nextLine = longerThanADay ? 'axisFormat %Y-%m-%d %H:%M \\n' : 'axisFormat %H:%M:%S \\n';\r\n            results.push(Promise.resolve(nextLine));\r\n        }\r\n\r\n        for(var event of historyEvents) {\r\n        \r\n            switch (event.EventType) {\r\n                case 'SubOrchestrationInstanceCompleted':\r\n\r\n                    if (!!event.SubOrchestrationId) {\r\n\r\n                        const subOrchestrationName = event.FunctionName;\r\n\r\n                        results.push(new Promise<string>((resolve, reject) => {\r\n                            this._loadDetails(event.SubOrchestrationId).then(details => {\r\n\r\n                                Promise.all(this.renderOrchestration(details.instanceId, details.name, false, details.historyEvents)).then(sequenceLines => {\r\n\r\n                                    resolve(sequenceLines.join(''));\r\n\r\n                                }, reject);\r\n\r\n                            }, err => {\r\n\r\n                                console.log(`Failed to load ${subOrchestrationName}. ${err.message}`);\r\n                                resolve(`%% Failed to load ${subOrchestrationName}. ${err.message} \\n`);\r\n                            });\r\n                        }));\r\n                    }\r\n\r\n                    break;\r\n                case 'TaskCompleted':\r\n\r\n                    var nextLine = `${event.FunctionName} ${this.formatDuration(event.DurationInMs)}: done, ${this.formatDateTime(event.ScheduledTime)}, ${this.formatDurationInSeconds(event.DurationInMs)} \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n\r\n                    break;\r\n                case 'TaskFailed':\r\n\r\n                    var nextLine = `${event.FunctionName} ${this.formatDuration(event.DurationInMs)}: crit, ${this.formatDateTime(event.ScheduledTime)}, ${this.formatDurationInSeconds(event.DurationInMs)} \\n`;\r\n                    results.push(Promise.resolve(nextLine));\r\n\r\n                    break;\r\n            }\r\n        }\r\n\r\n        return results;\r\n    }\r\n\r\n    private formatDateTime(timestamp: string): string {\r\n\r\n        return timestamp.substr(0, 23);\r\n    }\r\n\r\n    private formatDurationInSeconds(durationInMs: number): string {\r\n\r\n        return Math.round(durationInMs / 1000).toFixed(0) + 's';\r\n    }\r\n\r\n    private escapeOrchestrationId(id: string) {\r\n\r\n        return id.replace(/[:;]/g, ' ');\r\n    }\r\n}","import { observable, computed } from 'mobx';\r\n\r\nimport { IBackendClient } from '../services/IBackendClient';\r\nimport { DurableOrchestrationStatus } from '../states/DurableOrchestrationStatus';\r\nimport { ICustomTabState } from './ICustomTabState';\r\n\r\n// State of a custom liquid markup tab on OrchestrationDetails view\r\nexport class LiquidMarkupTabState implements ICustomTabState {\r\n\r\n    name: string = \"\";\r\n    readonly description: string = \"\";\r\n    readonly isMermaidDiagram: boolean = false;\r\n\r\n    @computed\r\n    get rawHtml(): string { return this._rawHtml; };\r\n\r\n    constructor(private _orchestrationId: string, private _backendClient: IBackendClient) {\r\n    }\r\n\r\n    load(details: DurableOrchestrationStatus): Promise<void> {\r\n        \r\n        return new Promise<void>((resolve, reject) => {\r\n\r\n            const uri = `/orchestrations('${this._orchestrationId}')/custom-tab-markup('${this.name}')`;\r\n\r\n            this._backendClient.call('POST', uri).then(response => { \r\n\r\n                this._rawHtml = response;\r\n                console.log(this._rawHtml);\r\n                resolve();\r\n\r\n            }, reject);\r\n        });\r\n    }\r\n\r\n    @observable\r\n    private _rawHtml: string;\r\n}","import { observable, computed } from 'mobx';\r\n\r\nimport { DurableOrchestrationStatus } from '../states/DurableOrchestrationStatus';\r\nimport { ErrorMessageState } from './ErrorMessageState';\r\nimport { IBackendClient } from '../services/IBackendClient';\r\nimport { ITypedLocalStorage } from './ITypedLocalStorage';\r\nimport { SequenceDiagramTabState } from './SequenceDiagramTabState';\r\nimport { ICustomTabState } from './ICustomTabState';\r\nimport { GanttDiagramTabState } from './GanttDiagramTabState';\r\nimport { LiquidMarkupTabState } from './LiquidMarkupTabState';\r\n\r\n// State of OrchestrationDetails view\r\nexport class OrchestrationDetailsState extends ErrorMessageState {\r\n\r\n    // Tab currently selected\r\n    @computed\r\n    get selectedTabIndex(): number { return this._selectedTabIndex; }\r\n    set selectedTabIndex(val: number) {\r\n\r\n        this._selectedTabIndex = val;\r\n        this.loadCustomTabIfNeeded();\r\n    }\r\n\r\n    get selectedTab(): ICustomTabState {\r\n        return !this._selectedTabIndex ? null : this._tabStates[this._selectedTabIndex - 1];\r\n    }\r\n\r\n    @observable\r\n    details: DurableOrchestrationStatus = new DurableOrchestrationStatus();\r\n\r\n    @computed\r\n    get orchestrationId(): string { return this._orchestrationId; }\r\n\r\n    @computed\r\n    get inProgress(): boolean { return this._inProgress; };\r\n\r\n    @computed\r\n    get autoRefresh(): number { return this._autoRefresh; }\r\n    set autoRefresh(val: number) {\r\n        this._autoRefresh = val;\r\n        this._localStorage.setItem('autoRefresh', this._autoRefresh.toString());\r\n        this.loadDetails();\r\n    }\r\n\r\n    @computed\r\n    get raiseEventDialogOpen(): boolean { return this._raiseEventDialogOpen; }\r\n    set raiseEventDialogOpen(val: boolean) {\r\n        this._raiseEventDialogOpen = val;\r\n        this.eventName = '';\r\n        this.eventData = '';\r\n    }\r\n\r\n    @computed\r\n    get setCustomStatusDialogOpen(): boolean { return this._setCustomStatusDialogOpen; }\r\n    set setCustomStatusDialogOpen(val: boolean) {\r\n        this._setCustomStatusDialogOpen = val;\r\n        this.newCustomStatus = !!this.details.customStatus ? JSON.stringify(this.details.customStatus) : '';\r\n    }\r\n\r\n    @computed\r\n    get restartDialogOpen(): boolean { return this._restartDialogOpen; }\r\n    set restartDialogOpen(val: boolean) {\r\n        this._restartDialogOpen = val;\r\n        this.restartWithNewInstanceId = true;\r\n    }\r\n\r\n    @computed\r\n    get isCustomStatusDirty(): boolean { \r\n\r\n        if (!this.details.customStatus) {\r\n            return !!this.newCustomStatus;\r\n        }\r\n\r\n        return this.newCustomStatus !== JSON.stringify(this.details.customStatus);\r\n    }\r\n\r\n    @observable\r\n    rewindConfirmationOpen: boolean = false;\r\n    @observable\r\n    terminateConfirmationOpen: boolean = false;\r\n    @observable\r\n    purgeConfirmationOpen: boolean = false;\r\n\r\n    @observable\r\n    eventName: string;\r\n    @observable\r\n    eventData: string;\r\n    @observable\r\n    newCustomStatus: string;\r\n    @observable\r\n    restartWithNewInstanceId: boolean = true;\r\n\r\n    @computed\r\n    get tabStates(): ICustomTabState[] { return this._tabStates; }\r\n\r\n    get backendClient(): IBackendClient { return this._backendClient; }\r\n\r\n    constructor(private _orchestrationId: string,\r\n        private _backendClient: IBackendClient,\r\n        private _localStorage: ITypedLocalStorage<OrchestrationDetailsState>) {\r\n        super();\r\n\r\n        const autoRefreshString = this._localStorage.getItem('autoRefresh');\r\n        if (!!autoRefreshString) {\r\n            this._autoRefresh = Number(autoRefreshString);\r\n        }\r\n    }\r\n\r\n    rewind() {\r\n        this.rewindConfirmationOpen = false;\r\n\r\n        const uri = `/orchestrations('${this._orchestrationId}')/rewind`;\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('POST', uri).then(() => {\r\n            this._inProgress = false;\r\n            this.loadDetails();\r\n        }, err => {\r\n            this._inProgress = false;\r\n            this.errorMessage = `Failed to rewind: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        });\r\n    }\r\n\r\n    terminate() {\r\n        this.terminateConfirmationOpen = false;\r\n\r\n        const uri = `/orchestrations('${this._orchestrationId}')/terminate`;\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('POST', uri).then(() => {\r\n            this._inProgress = false;\r\n            this.loadDetails();\r\n        }, err => {\r\n            this._inProgress = false;\r\n            this.errorMessage = `Failed to terminate: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        });\r\n    }\r\n\r\n    purge() {\r\n        this.purgeConfirmationOpen = false;\r\n\r\n        const uri = `/orchestrations('${this._orchestrationId}')/purge`;\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('POST', uri).then(() => {\r\n            this._inProgress = false;\r\n            this.details = new DurableOrchestrationStatus();\r\n            this._tabStates = [];\r\n        }, err => {\r\n            this._inProgress = false;\r\n            this.errorMessage = `Failed to purge: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        });\r\n    }\r\n\r\n    restart() {\r\n        this.restartDialogOpen = false;\r\n\r\n        const uri = `/orchestrations('${this._orchestrationId}')/restart`;\r\n        const requestBody = { restartWithNewInstanceId: this.restartWithNewInstanceId };\r\n\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('POST', uri, requestBody).then(() => {\r\n            this._inProgress = false;\r\n            this.loadDetails();\r\n        }, err => {\r\n            this._inProgress = false;\r\n            this.errorMessage = `Failed to restart: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        });\r\n    }\r\n\r\n    raiseEvent() {\r\n\r\n        const uri = `/orchestrations('${this._orchestrationId}')/raise-event`;\r\n        const requestBody = { name: this.eventName, data: null };\r\n\r\n        try {\r\n            requestBody.data = JSON.parse(this.eventData);\r\n        } catch (err) {\r\n            this.errorMessage = `Failed to parse event data: ${err.message}`;\r\n            return;\r\n        } finally {\r\n            this.raiseEventDialogOpen = false;\r\n        }\r\n\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('POST', uri, requestBody).then(() => {\r\n            this._inProgress = false;\r\n            this.loadDetails();\r\n        }, err => {\r\n            this._inProgress = false;\r\n            this.errorMessage = `Failed to raise an event: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        });\r\n    }\r\n\r\n    setCustomStatus() {\r\n\r\n        const uri = `/orchestrations('${this._orchestrationId}')/set-custom-status`;\r\n        var requestBody = null;\r\n\r\n        try {\r\n\r\n            if (!!this.newCustomStatus) {\r\n                requestBody = JSON.parse(this.newCustomStatus);\r\n            }\r\n\r\n        } catch (err) {\r\n            this.errorMessage = `Failed to parse custom status: ${err.message}`;\r\n            return;\r\n        } finally {\r\n            this.setCustomStatusDialogOpen = false;\r\n        }\r\n\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('POST', uri, requestBody).then(() => {\r\n            this._inProgress = false;\r\n            this.loadDetails();\r\n        }, err => {\r\n            this._inProgress = false;\r\n            this.errorMessage = `Failed to set custom status: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        });\r\n    }\r\n    \r\n    loadDetails() {\r\n\r\n        if (!!this.inProgress) {\r\n            // Doing auto-refresh\r\n            this.setAutoRefresh();\r\n            return;\r\n        }\r\n        this._inProgress = true;\r\n\r\n        this.internalLoadDetails(this._orchestrationId).then(response => {\r\n        \r\n            this.details = response;\r\n\r\n            // Doing auto-refresh\r\n            this.setAutoRefresh();\r\n\r\n            var tabStateIndex = 0;\r\n\r\n            // Loading sequence diagram tab\r\n            if (this.details.entityType === \"Orchestration\") {\r\n               \r\n                if (this._tabStates.length <= tabStateIndex) {\r\n                    this._tabStates.push(new SequenceDiagramTabState((orchId) => this.internalLoadDetails(orchId)));\r\n                    this._tabStates.push(new GanttDiagramTabState((orchId) => this.internalLoadDetails(orchId)));\r\n                }\r\n                tabStateIndex += 2;\r\n            }\r\n\r\n            // Loading custom tabs\r\n            if (!!this.details.tabTemplateNames) {\r\n                for (var templateName of this.details.tabTemplateNames) {\r\n\r\n                    if (this._tabStates.length <= tabStateIndex) {\r\n                        this._tabStates.push(new LiquidMarkupTabState(this._orchestrationId, this._backendClient));\r\n                    }\r\n                    this._tabStates[tabStateIndex].name = templateName;\r\n                    tabStateIndex++;\r\n                }                \r\n            }\r\n\r\n            this._inProgress = false;\r\n\r\n            // Reloading the current custom tab as well\r\n            this.loadCustomTabIfNeeded();\r\n            \r\n        }, err => {\r\n            this._inProgress = false;\r\n\r\n            // Cancelling auto-refresh just in case\r\n            this._autoRefresh = 0;\r\n\r\n            this.errorMessage = `Load failed: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        });\r\n    }\r\n\r\n    private loadCustomTabIfNeeded(): void {\r\n\r\n        if (!!this._inProgress || !this.selectedTab) {\r\n            return;\r\n        }\r\n\r\n        this._inProgress = true;\r\n\r\n        this.selectedTab.load(this.details).then(() => {}, err => { \r\n                \r\n            // Cancelling auto-refresh just in case\r\n            this._autoRefresh = 0;\r\n\r\n            this.errorMessage = `Failed to load Sequence Diagram: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n\r\n        }).finally(() => {\r\n            this._inProgress = false;\r\n        });\r\n    }\r\n\r\n    private setAutoRefresh(): void {\r\n\r\n        if (!this._autoRefresh) {\r\n            return;\r\n        }\r\n\r\n        if (!!this._autoRefreshToken) {\r\n            clearTimeout(this._autoRefreshToken);\r\n        }\r\n        this._autoRefreshToken = setTimeout(() => this.loadDetails(), this._autoRefresh * 1000);\r\n    }\r\n\r\n    @observable\r\n    private _tabStates: ICustomTabState[] = [];\r\n\r\n    @observable\r\n    private _selectedTabIndex: number = 0;\r\n    @observable\r\n    private _inProgress: boolean = false;\r\n    @observable\r\n    private _raiseEventDialogOpen: boolean = false;\r\n    @observable\r\n    private _setCustomStatusDialogOpen: boolean = false;\r\n    @observable\r\n    private _restartDialogOpen: boolean = false;\r\n    @observable\r\n    private _autoRefresh: number = 0;\r\n\r\n    private _autoRefreshToken: NodeJS.Timeout;\r\n\r\n    private internalLoadDetails(orchestrationId: string): Promise<DurableOrchestrationStatus> {\r\n\r\n        const uri = `/orchestrations('${orchestrationId}')`;\r\n        return this._backendClient.call('GET', uri).then(response => {\r\n\r\n            if (!response) {\r\n                throw { message: `Orchestration '${orchestrationId}' not found.` };\r\n            }\r\n\r\n            // Based on backend implementation, this field can appear to be called differently ('historyEvents' vs. 'history')\r\n            // Fixing that here\r\n            if (!!response.history) {\r\n                response.historyEvents = response.history;\r\n            }\r\n\r\n            return response;\r\n        });\r\n    }\r\n}","import { observable, computed } from 'mobx'\r\nimport moment from 'moment';\r\n\r\nimport { DateTimeHelpers } from '../DateTimeHelpers';\r\nimport { IBackendClient } from '../services/IBackendClient';\r\nimport { RuntimeStatus, EntityType } from './DurableOrchestrationStatus';\r\nimport { ErrorMessageState } from './ErrorMessageState';\r\n\r\n// State of Purge History Dialog\r\nexport class PurgeHistoryDialogState extends ErrorMessageState {\r\n\r\n    @computed\r\n    get dialogOpen(): boolean { return this._dialogOpen; };\r\n    set dialogOpen(value: boolean) {\r\n        this._dialogOpen = value;\r\n\r\n        if (value) {\r\n\r\n            this._instancesDeleted = null;\r\n\r\n            this.timeFrom = moment().subtract(1, 'days').utc();\r\n            this.timeTill = moment().utc();\r\n\r\n            this._statuses = new Set<RuntimeStatus>([\"Completed\", \"Terminated\"]);\r\n\r\n            this.entityType = \"Orchestration\";\r\n        }\r\n    }\r\n\r\n    @computed\r\n    get instancesDeleted(): number | null { return this._instancesDeleted; };\r\n\r\n    @computed\r\n    get inProgress(): boolean { return this._inProgress; };\r\n\r\n    @computed\r\n    get isValid(): boolean {\r\n        return this._statuses.size > 0 && DateTimeHelpers.isValidMoment(this.timeFrom) && DateTimeHelpers.isValidMoment(this.timeTill);\r\n    };\r\n\r\n    constructor(private _backendClient: IBackendClient) {\r\n        super();\r\n    }\r\n\r\n    purgeHistory() {\r\n\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('POST', '/purge-history', {\r\n            entityType: this.entityType,\r\n            timeFrom: this.timeFrom.toISOString(),\r\n            timeTill: this.timeTill.toISOString(),\r\n            statuses: Array.from(this._statuses.values())\r\n        }).then(response => {\r\n\r\n            this._instancesDeleted = response.instancesDeleted;\r\n\r\n        }, err => {\r\n            this.errorMessage = `Purge history failed: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        }).finally(() => {\r\n            this._inProgress = false;\r\n        });\r\n    }\r\n\r\n    @observable\r\n    timeFrom: moment.Moment;\r\n    @observable\r\n    timeTill: moment.Moment;\r\n\r\n    @observable\r\n    entityType: EntityType = \"Orchestration\";\r\n\r\n    getStatusIncluded(status: RuntimeStatus) {\r\n        return this._statuses.has(status);\r\n    }\r\n\r\n    setStatusIncluded(status: RuntimeStatus, included: boolean) {\r\n        if (included) {\r\n            this._statuses.add(status);\r\n        } else {\r\n            this._statuses.delete(status);\r\n        }\r\n    }\r\n\r\n    @observable\r\n    private _statuses: Set<RuntimeStatus> = new Set<RuntimeStatus>();\r\n\r\n    @observable\r\n    private _dialogOpen: boolean = false;\r\n    \r\n    @observable\r\n    private _inProgress: boolean = false;\r\n\r\n    @observable\r\n    private _instancesDeleted: number | null = null;\r\n}","import { observable, computed } from 'mobx'\r\nimport { IBackendClient } from '../services/IBackendClient';\r\nimport { ErrorMessageState } from './ErrorMessageState';\r\n\r\n// State of Clean Entity Storage Dialog\r\nexport class CleanEntityStorageDialogState extends ErrorMessageState {\r\n\r\n    @computed\r\n    get dialogOpen(): boolean { return this._dialogOpen; };\r\n    set dialogOpen(isOpen: boolean) {\r\n        this._dialogOpen = isOpen;\r\n\r\n        if (isOpen) {\r\n            this._response = null;\r\n            this.removeEmptyEntities = true;\r\n            this.releaseOrphanedLocks = true;\r\n        }\r\n    }\r\n\r\n    @computed\r\n    get response(): CleanEntityStorageResponse | null { return this._response; };\r\n\r\n    @computed\r\n    get inProgress(): boolean { return this._inProgress; };\r\n\r\n    @computed\r\n    get isValid(): boolean {\r\n        return true;\r\n    };\r\n\r\n    @observable\r\n    removeEmptyEntities: boolean;\r\n    @observable\r\n    releaseOrphanedLocks: boolean;\r\n    \r\n    constructor(private _backendClient: IBackendClient) {\r\n        super();\r\n    }\r\n\r\n    clean() {\r\n\r\n        this._inProgress = true;\r\n\r\n        this._backendClient.call('POST', '/clean-entity-storage', {\r\n            removeEmptyEntities: this.removeEmptyEntities,\r\n            releaseOrphanedLocks: this.releaseOrphanedLocks\r\n        }).then(response => {\r\n            this._response = response;\r\n        }, err => {\r\n            this.errorMessage = `Clean Entity Storage failed: ${err.message}.${(!!err.response ? err.response.data : '')} `;\r\n        }).finally(() => {\r\n            this._inProgress = false;\r\n        });\r\n    }\r\n\r\n    @observable\r\n    private _dialogOpen: boolean = false;\r\n    \r\n    @observable\r\n    private _inProgress: boolean = false;\r\n\r\n    @observable\r\n    private _response: CleanEntityStorageResponse | null = null;\r\n}\r\n\r\nexport class CleanEntityStorageResponse\r\n{\r\n    numberOfEmptyEntitiesRemoved: number;\r\n    numberOfOrphanedLocksRemoved: number;\r\n}","import { ITypedLocalStorage } from './ITypedLocalStorage';\r\n\r\n// Stores field values in a localStorage\r\nexport class TypedLocalStorage<T> implements ITypedLocalStorage<T>\r\n{\r\n    constructor(private _prefix: string) { }\r\n\r\n    setItem(fieldName: Extract<keyof T, string>, value: string) {\r\n        localStorage.setItem(`${this._prefix}::${fieldName}`, value);\r\n    }\r\n\r\n    setItems(items: { fieldName: Extract<keyof T, string>, value: string | null }[]) {\r\n        for (const item of items) {\r\n            if (item.value === null) {\r\n                localStorage.removeItem(`${this._prefix}::${item.fieldName}`);\r\n            } else {\r\n                localStorage.setItem(`${this._prefix}::${item.fieldName}`, item.value);\r\n            }\r\n        }\r\n    }\r\n\r\n    getItem(fieldName: Extract<keyof T, string>): string | null {\r\n        return localStorage.getItem(`${this._prefix}::${fieldName}`);\r\n    }\r\n\r\n    removeItem(fieldName: Extract<keyof T, string>) {\r\n        localStorage.removeItem(`${this._prefix}::${fieldName}`);\r\n    }\r\n}\r\n","import { Method } from 'axios';\r\nimport { IBackendClient } from './IBackendClient';\r\n\r\n// IBackendClient implementation for VsCode extension, forwards HTTP requests to VsCode\r\nexport class VsCodeBackendClient implements IBackendClient {\r\n\r\n    get isVsCode(): boolean { return true; }\r\n\r\n    constructor(private _vsCodeApi: any) {\r\n\r\n        // Handling responses from VsCode\r\n        window.addEventListener('message', event => {\r\n\r\n            const message = event.data;\r\n\r\n            // handling menu commands\r\n            const requestHandler = this._handlers[message.id];\r\n            if (!!requestHandler) {\r\n\r\n                try {\r\n                    requestHandler(message.data);\r\n                } catch(err) {\r\n                    console.log('Failed to handle response from VsCode: ' + err);\r\n                }\r\n\r\n                return;\r\n            }\r\n\r\n            // handling HTTP responses\r\n            const requestPromise = this._requests[message.id];\r\n            if (!requestPromise) {\r\n                return;\r\n            }\r\n\r\n            if (!!message.err) {\r\n                requestPromise.reject(message.err);\r\n            } else {\r\n                requestPromise.resolve(message.data);\r\n            }\r\n\r\n            delete this._requests[message.id];\r\n        });\r\n    }\r\n\r\n    call(method: Method | 'OpenInNewWindow', url: string, data?: any): Promise<any> {\r\n\r\n        const requestId = Math.random().toString();\r\n\r\n        // Sending request to VsCode\r\n        this._vsCodeApi.postMessage({ id: requestId, method, url, data });\r\n\r\n        return new Promise<any>((resolve, reject) => {\r\n            this._requests[requestId] = { resolve, reject };\r\n        });\r\n    }\r\n\r\n    setCustomHandlers(purgeHistoryHandler: () => void, cleanEntityStorageHandler: () => void) {\r\n\r\n        this._handlers['purgeHistory'] = purgeHistoryHandler;\r\n        this._handlers['cleanEntityStorage'] = cleanEntityStorageHandler;\r\n\r\n        // Notifying VsCode that we're ready to process messages\r\n        // Cannot do this in ctor, because VsCodeBackendClient and PurgeHistoryDialogState depend on each other\r\n        this._vsCodeApi.postMessage({ method: 'IAmReady' });\r\n    }\r\n\r\n    private _handlers: {\r\n        [id: string]: (data: any) => void\r\n    } = {};\r\n\r\n    private _requests: {\r\n        [id: string]: {\r\n            resolve: (value?: any) => void,\r\n            reject: (reason?: any) => void\r\n        }\r\n    } = {};\r\n}","import { ITypedLocalStorage } from './ITypedLocalStorage';\r\n\r\n// A global variable declared in index.html and replaced by VsCode extension\r\ndeclare const StateFromVsCode: {};\r\n\r\n// Stores field values in VsCode\r\nexport class VsCodeTypedLocalStorage<T> implements ITypedLocalStorage<T>\r\n{\r\n    constructor(private _prefix: string, private _vsCodeApi: any) { \r\n        this._state = StateFromVsCode[this._prefix];\r\n        if (!this._state) {\r\n            this._state = {};\r\n        }\r\n    }\r\n\r\n    setItem(fieldName: Extract<keyof T, string>, value: string) {\r\n\r\n        this._state[fieldName] = value\r\n        this.save();\r\n    }\r\n\r\n    setItems(items: { fieldName: Extract<keyof T, string>, value: string | null }[]) {\r\n\r\n        for (const item of items) {\r\n\r\n            if (item.value === null) {\r\n                delete this._state[item.fieldName];\r\n            } else {\r\n                this._state[item.fieldName] = item.value;\r\n            }\r\n        }\r\n\r\n        this.save();\r\n    }\r\n\r\n    getItem(fieldName: Extract<keyof T, string>): string | null {\r\n\r\n        return this._state[fieldName];\r\n    }\r\n\r\n    removeItem(fieldName: Extract<keyof T, string>) {\r\n\r\n        delete this._state[fieldName];\r\n        this.save();\r\n    }\r\n\r\n    private readonly _state: any;\r\n\r\n    private save(): void {\r\n        this._vsCodeApi.postMessage({ method: 'PersistState', key: this._prefix, data: this._state });\r\n    }\r\n}\r\n","import { observable, computed } from 'mobx';\r\n\r\nimport { IBackendClient } from '../services/IBackendClient';\r\nimport { BackendClient } from '../services/BackendClient';\r\nimport { LoginState } from './LoginState';\r\nimport { MainMenuState } from './MainMenuState';\r\nimport { OrchestrationsState } from './OrchestrationsState';\r\nimport { OrchestrationDetailsState } from './OrchestrationDetailsState';\r\nimport { PurgeHistoryDialogState } from './PurgeHistoryDialogState';\r\nimport { CleanEntityStorageDialogState } from './CleanEntityStorageDialogState';\r\nimport { TypedLocalStorage } from './TypedLocalStorage';\r\nimport { VsCodeBackendClient } from '../services/VsCodeBackendClient';\r\nimport { VsCodeTypedLocalStorage } from './VsCodeTypedLocalStorage';\r\n\r\n// This method is provided by VsCode, when running inside a WebView\r\ndeclare const acquireVsCodeApi: () => any;\r\n\r\n// A global variable declared in index.html and replaced by VsCode extension\r\ndeclare const OrchestrationIdFromVsCode: string;\r\n\r\n// Main Application State\r\nexport class MainState  {\r\n    \r\n    loginState?: LoginState;    \r\n    mainMenuState?: MainMenuState;\r\n    orchestrationsState?: OrchestrationsState;\r\n    orchestrationDetailsState?: OrchestrationDetailsState;\r\n    purgeHistoryDialogState: PurgeHistoryDialogState;\r\n    cleanEntityStorageDialogState: CleanEntityStorageDialogState;\r\n\r\n    @computed\r\n    get typedInstanceId(): string {\r\n        return this._typedInstanceId;\r\n    }\r\n    set typedInstanceId(s: string) {\r\n        this._typedInstanceId = s;\r\n        this.reloadSuggestions();\r\n    }\r\n\r\n    @computed\r\n    get suggestions(): string[] {\r\n        return this._suggestions;\r\n    }\r\n\r\n    @computed\r\n    get isExactMatch(): boolean {\r\n        return this._suggestions.length === 1 && this._suggestions[0] === this._typedInstanceId;\r\n    }\r\n    \r\n    constructor() {\r\n\r\n        // checking whether we're inside VsCode\r\n        var vsCodeApi: any = undefined;\r\n        try {\r\n            vsCodeApi = acquireVsCodeApi();\r\n        } catch { }\r\n\r\n        if (!!vsCodeApi) {\r\n\r\n            const backendClient = new VsCodeBackendClient(vsCodeApi);\r\n            this._backendClient = backendClient;\r\n\r\n            this.purgeHistoryDialogState = new PurgeHistoryDialogState(backendClient);\r\n            this.cleanEntityStorageDialogState = new CleanEntityStorageDialogState(backendClient);\r\n\r\n            if (!!this.orchestrationId) {\r\n                this.orchestrationDetailsState = new OrchestrationDetailsState(this.orchestrationId,\r\n                    backendClient,\r\n                    new VsCodeTypedLocalStorage<OrchestrationDetailsState>('OrchestrationDetailsState', vsCodeApi));\r\n            } else {\r\n                this.orchestrationsState = new OrchestrationsState(backendClient,\r\n                    new VsCodeTypedLocalStorage<OrchestrationsState>('OrchestrationsState', vsCodeApi));\r\n\r\n                backendClient.setCustomHandlers(\r\n                    () => this.purgeHistoryDialogState.dialogOpen = true,\r\n                    () => this.cleanEntityStorageDialogState.dialogOpen = true\r\n                );\r\n            }\r\n            \r\n        } else {\r\n\r\n            this.loginState = new LoginState(this.rootUri);\r\n\r\n            const backendClient = new BackendClient(() => this.loginState.getAuthorizationHeaderAsync());\r\n            this._backendClient = backendClient;\r\n\r\n            this.purgeHistoryDialogState = new PurgeHistoryDialogState(backendClient);\r\n            this.cleanEntityStorageDialogState = new CleanEntityStorageDialogState(backendClient);\r\n\r\n            if (!!this.orchestrationId) {\r\n                this.orchestrationDetailsState = new OrchestrationDetailsState(this.orchestrationId,\r\n                    backendClient, \r\n                    new TypedLocalStorage<OrchestrationDetailsState>('OrchestrationDetailsState'));\r\n            } else {\r\n                this.mainMenuState = new MainMenuState(backendClient, this.purgeHistoryDialogState, this.cleanEntityStorageDialogState);\r\n                this.orchestrationsState = new OrchestrationsState(backendClient,\r\n                    new TypedLocalStorage<OrchestrationsState>('OrchestrationsState'));\r\n            }\r\n        }\r\n    }\r\n\r\n    // Opens the entered orchestrationId in a new tab\r\n    goto() {\r\n        window.open(`/orchestrations/${this._typedInstanceId}`);\r\n        this._typedInstanceId = '';\r\n        this._suggestions = [];\r\n    }\r\n\r\n    @observable\r\n    private _suggestions: string[] = [];\r\n    @observable\r\n    private _typedInstanceId: string = '';\r\n\r\n    private readonly _backendClient: IBackendClient;\r\n\r\n    private readonly PathPrefix = `/orchestrations/`;\r\n\r\n    // Extracts orchestrationId from URL or from VsCode\r\n    private get orchestrationId(): string {\r\n\r\n        if (!!OrchestrationIdFromVsCode) {\r\n            return OrchestrationIdFromVsCode;\r\n        }\r\n\r\n        const pos = window.location.pathname.lastIndexOf(this.PathPrefix);\r\n        if (pos < 0) {\r\n            return '';\r\n        }\r\n\r\n        return window.location.pathname.substr(pos + this.PathPrefix.length);\r\n    }\r\n\r\n    private get rootUri(): string {\r\n\r\n        const pos = window.location.href.lastIndexOf(this.PathPrefix);\r\n        if (pos < 0) {\r\n            return window.location.href;\r\n        } else {\r\n            return window.location.href.substring(0, pos);\r\n        }\r\n    }\r\n\r\n    // Reloads list of suggested instanceIds\r\n    private reloadSuggestions(): void {\r\n\r\n        if (!this._typedInstanceId || this._typedInstanceId.length < 2) {\r\n            this._suggestions = [];\r\n            return;\r\n        }\r\n\r\n        const uri = `/id-suggestions(prefix='${this._typedInstanceId}')`;\r\n        this._backendClient.call('GET', uri).then(response => {\r\n\r\n            if (!response || !this._typedInstanceId) {\r\n                this._suggestions = [];\r\n            } else {\r\n                this._suggestions = response;\r\n            }\r\n        });\r\n    }\r\n}","import * as React from 'react';\r\nimport * as ReactDOM from 'react-dom';\r\n\r\nimport registerServiceWorker from './registerServiceWorker';\r\n\r\nimport './index.css';\r\n\r\nimport { Main } from './components/Main';\r\nimport { MainState } from './states/MainState';\r\n\r\n// This is the app's global state. It consists of multiple parts, consumed by multiple nested components\r\nconst appState = new MainState();\r\n\r\nReactDOM.render(\r\n    <Main state={appState}/>,\r\n    document.getElementById('root') as HTMLElement\r\n);\r\n\r\nregisterServiceWorker();\r\n"],"sourceRoot":""}